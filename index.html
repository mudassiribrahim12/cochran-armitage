<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
    <title>CATrend Analyzer – Web tool for Cochran-Armitage Trend Test analysis</title>
    
    <!-- SEO Meta Tags -->
    <meta name="title" content="CATrend Analyzer">
    <meta name="description" content="Free online statistical analysis tool for Cochran-Armitage Trend Test. Analyze trends in proportions across ordered categories for clinical trials, epidemiology, and public health research.">
    <meta name="keywords" content="Cochran-Armitage Trend Test, CATT, trend analysis, statistics calculator, research tools, epidemiological analysis, clinical trial statistics, free calculator, research calculator, academic tools">
    <meta name="theme-color" content="#1a73e8">
    <meta name="author" content="Mudasir Mohammed Ibrahim">
    
    <!-- Cache Control -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Favicon and App Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/mudassiribrahim12/cochran-armitage/main/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/mudassiribrahim12/cochran-armitage/main/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/mudassiribrahim12/cochran-armitage/main/favicon-16x16.png">
    <link rel="manifest" href="https://raw.githubusercontent.com/mudassiribrahim12/cochran-armitage/main/site.webmanifest">
    
        <!-- Additional SEO for faster indexing -->
    <meta name="google-site-verification" content="PGq_oDNzKGPvdcDK-DzNc2VYrCckkJxWLyiqq7OdHq0" />
    <meta name="msvalidate.01" content="YOUR_BING_VERIFICATION_CODE" />
    <meta name="yandex-verification" content="YOUR_YANDEX_VERIFICATION_CODE" />
    
    <!-- Improved Robots Meta -->
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large" />
    
    <!-- Language and Geographic Targeting -->
    <meta name="language" content="English" />
    <meta name="geo.region" content="GH" />
    <meta name="geo.placename" content="Ghana" />
    
    <!-- News and Sitemap -->
    <meta name="google-site-verification" content="PGq_oDNzKGPvdcDK-DzNc2VYrCckkJxWLyiqq7OdHq0" />
    <link rel="sitemap" type="application/xml" title="Sitemap" href="https://catrendanalyzer.mudasiribrahim.com/sitemap.xml" />
    
    <!-- Open Graph / Social Media -->
    <meta property="og:site_name" content="CATrend Analyzer">
    <meta property="og:title" content="CATrend Analyzer – Open-Source Cochran–Armitage Trend Test (CATT) Web-Based Software">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://catrendanalyzer.mudasiribrahim.com/">
    <meta property="og:description" content="Free online statistical analysis tool for Cochran-Armitage Trend Test. Analyze trends in proportions across ordered categories for clinical trials, epidemiology, and public health research.">
    <meta property="og:image" content="https://raw.githubusercontent.com/mudassiribrahim12/me/main/mysecondprofile.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://catrendanalyzer.mudasiribrahim.com/">
    <meta property="twitter:title" content="CATrend Analyzer – Open-Source Cochran–Armitage Trend Test (CATT) Web-Based Software">
    <meta property="twitter:description" content="Free online statistical analysis tool for Cochran-Armitage Trend Test. Analyze trends in proportions across ordered categories for clinical trials, epidemiology, and public health research.">
    <meta property="twitter:image" content="https://raw.githubusercontent.com/mudassiribrahim12/me/main/mysecondprofile.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://catrendanalyzer.mudasiribrahim.com/">
    
       <!-- Alternate language versions (if you add translations later) -->
    <link rel="alternate" hreflang="en" href="https://catrendanalyzer.mudasiribrahim.com/" />
    <link rel="alternate" hreflang="x-default" href="https://catrendanalyzer.mudasiribrahim.com/" />
    
    <!-- Robots -->
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    
    <!-- Google Site Verification -->
    <meta name="google-site-verification" content="PGq_oDNzKGPvdcDK-DzNc2VYrCckkJxWLyiqq7OdHq0" />
    
    <!-- JSON-LD Schema Markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "@id": "https://catrendanalyzer.mudasiribrahim.com/#software",
        "name": "CATrend Analyzer – Open-Source Cochran–Armitage Trend Test (CATT) Web-Based Software",
        "url": "https://catrendanalyzer.mudasiribrahim.com/",
        "image": "https://raw.githubusercontent.com/mudassiribrahim12/me/main/mysecondprofile.jpg",
        "logo": "https://raw.githubusercontent.com/mudassiribrahim12/me/main/favicon-32x32.png",
        "description": "Free online statistical analysis tool for Cochran-Armitage Trend Test. Analyze trends in proportions across ordered categories for clinical trials, epidemiology, and public health research.",
        "operatingSystem": "Web",
        "applicationCategory": "StatisticalAnalysisApplication",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Person",
            "@id": "https://mudasiribrahim.com/#person",
            "name": "Mudasir Mohammed Ibrahim",
            "jobTitle": "Registered Nurse and Health Researcher",
            "knowsAbout": ["Statistical Analysis", "Clinical Research", "Epidemiology", "Healthcare Research", "R Shiny Applications"]
        },
        "featureList": [
            "Interactive contingency tables",
            "Cochran-Armitage trend test analysis",
            "Data visualization with charts",
            "Export to Microsoft Word reports",
            "Statistical interpretation",
            "Trend analysis across ordered categories",
            "Clinical trial statistics"
        ],
        "softwareVersion": "1.0.0",
        "datePublished": "2026-02-01"
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "@id": "https://catrendanalyzer.mudasiribrahim.com/#webapplication",
        "url": "https://catrendanalyzer.mudasiribrahim.com/",
        "name": "CATrend Analyzer – Open-Source Cochran–Armitage Trend Test (CATT) Web-Based Software",
        "description": "Free online statistical analysis tool for Cochran-Armitage Trend Test. Analyze trends in proportions across ordered categories for clinical trials, epidemiology, and public health research.",
        "browserRequirements": "Requires JavaScript. Works in all modern browsers.",
        "applicationCategory": "StatisticalAnalysisApplication",
        "operatingSystem": "Any",
        "author": {
            "@type": "Person",
            "@id": "https://mudasiribrahim.com/#person",
            "name": "Mudasir Mohammed Ibrahim",
            "url": "https://mudasiribrahim.com/",
            "sameAs": [
                "https://orcid.org/0000-0002-9049-8222",
                "https://scholar.google.com/citations?user=xEFzAvgAAAAJ&hl=en",
                "https://github.com/mudassiribrahim30"
            ]
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "150"
        }
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "@id": "https://catrendanalyzer.mudasiribrahim.com/#website",
        "url": "https://catrendanalyzer.mudasiribrahim.com/",
        "name": "CATrend Analyzer",
        "description": "Free online statistical analysis tool for Cochran-Armitage Trend Test",
        "publisher": {
            "@id": "https://catrendanalyzer.mudasiribrahim.com/#organization"
        },
        "inLanguage": "en"
    }
    </script>
    
        <!-- Additional Schema for Better Ranking -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "ItemList",
        "name": "Top Cochran-Armitage Trend Test Calculators",
        "description": "Best free online tools for Cochran-Armitage Trend Test analysis",
        "numberOfItems": 1,
        "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "url": "https://catrendanalyzer.mudasiribrahim.com/",
            "name": "CATrend Analyzer - Free Cochran-Armitage Test Calculator"
        }]
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Perform Cochran-Armitage Trend Test",
        "description": "Step-by-step guide to perform trend analysis using CATrend Analyzer",
        "totalTime": "PT5M",
        "tool": {
            "@type": "HowToTool",
            "name": "CATrend Analyzer"
        },
        "step": [
            {
                "@type": "HowToStep",
                "text": "Enter your contingency table data with ordered categories",
                "name": "Data Entry"
            },
            {
                "@type": "HowToStep",
                "text": "Select test type (one-sided or two-sided)",
                "name": "Configure Test"
            },
            {
                "@type": "HowToStep",
                "text": "Click Run Analysis to get Z-statistic and p-value",
                "name": "Run Analysis"
            },
            {
                "@type": "HowToStep",
                "text": "Export results to Word, Excel, or CSV format",
                "name": "Export Results"
            }
        ]
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is the Cochran-Armitage Trend Test?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "The Cochran-Armitage Trend Test is a statistical method used to detect trends in proportions across ordered categorical variables. It's commonly used in clinical trials, epidemiology, and public health research to analyze dose-response relationships or trends across ordered groups."
                }
            },
            {
                "@type": "Question",
                "name": "How do I calculate Cochran-Armitage test online for free?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "You can calculate the Cochran-Armitage test for free using CATrend Analyzer. Simply enter your contingency table data, select your test type, and click 'Run Analysis'. The tool automatically computes the Z-statistic, p-value, and provides statistical interpretation."
                }
            },
            {
                "@type": "Question",
                "name": "What are the assumptions of the Cochran-Armitage trend test?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "The main assumptions are: ordered categorical groups, independent observations, binary outcome variable, and sufficiently large sample size for normal approximation. The test also requires non-zero marginal totals."
                }
            },
            {
                "@type": "Question",
                "name": "Can I export Cochran-Armitage test results to Word?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, CATrend Analyzer allows you to export complete analysis reports to Microsoft Word format, including contingency tables, statistical results, charts, and proper citations for your research."
                }
            }
        ]
    }
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
</head>

    <style>
    :root {
    --primary: #1a73e8;
    --primary-dark: #0d62d9;
    --secondary: #444444; /* Changed from #5f6368 to darker gray */
    --success: #34a853;
    --warning: #f9ab00;
    --danger: #ea4335;
    --light: #f8f9fa;
    --dark: #000000; /* Changed from #202124 to black */
    --border: #dadce0;
    --shadow: 0 1px 3px rgba(0,0,0,0.12);
    --shadow-lg: 0 4px 12px rgba(0,0,0,0.08);
    --background: #ffffff;
    --text: #000000; /* CHANGED: Pure black instead of dark gray */
    
    /* Chart.js colors for light theme */
    --chart-bg: #ffffff;
    --chart-grid: #e5e5e5;
    --chart-text: #000000; /* CHANGED: Black for chart text */
    
    /* New variables */
    --primary-light: rgba(26, 115, 232, 0.1);
}

   /* Dark Theme Variables */
[data-theme="dark"] {
    --primary: #8ab4f8;
    --primary-dark: #669df6;
    --secondary: #cccccc; /* Changed from #9aa0a6 to lighter gray */
    --success: #81c995;
    --warning: #fbbc04;
    --danger: #f28b82;
    --light: #202124;
    --dark: #ffffff; /* Changed from #e8eaed to white */
    --border: #5f6368;
    --shadow: 0 1px 3px rgba(0,0,0,0.3);
    --shadow-lg: 0 4px 12px rgba(0,0,0,0.4);
    --background: #202124;
    --text: #ffffff; /* CHANGED: Pure white instead of light gray */
    
    /* Chart.js colors for dark theme */
    --chart-bg: #292a2d;
    --chart-grid: #5f6368;
    --chart-text: #ffffff; /* CHANGED: White for chart text */
    
    /* New variables for dark theme */
    --primary-light: rgba(138, 180, 248, 0.1);
}

/* ============================================
   MAKE ALL TEXT BLACK/NOT FADED - FIX
   ============================================ */

/* Make all regular body text black */
body {
    color: var(--text) !important;
    font-weight: 500 !important; /* Optional: make text slightly bolder */
}

/* Make paragraphs black */
p {
    color: var(--text) !important;
}

/* Make list items black */
li {
    color: var(--text) !important;
}

/* Make card content black */
.card {
    color: var(--text) !important;
}

/* Make feature descriptions black */
.feature-desc {
    color: var(--text) !important;
    opacity: 0.9 !important; /* Slightly transparent but still black */
}

/* Make tutorial text black */
.tutorial-step p {
    color: var(--text) !important;
    opacity: 0.9 !important;
}

/* Make alert text more visible */
.alert {
    color: var(--text) !important;
}

/* Make table text black */
.data-table td,
.data-table th,
.preview-table td,
.preview-table th {
    color: var(--text) !important;
}

/* Make formula box text black */
.formula-box {
    color: var(--text) !important;
}

/* Make reference items black */
.reference-item {
    color: var(--text) !important;
}

/* Make code block text more visible */
.code-block {
    color: #ffffff !important; /* Keep white for code blocks */
    background: #2d2d2d !important;
}

/* Make footer text black */
.main-footer,
.copyright {
    color: var(--text) !important;
}

/* Make hero description black */
.hero-description {
    color: var(--text) !important;
    opacity: 0.9 !important;
}

/* Make stat labels black */
.stat-label {
    color: var(--text) !important;
    opacity: 0.8 !important;
}

        /* Smooth theme transition */
        body {
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 14px;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text);
            line-height: 1.6;
            background: var(--background);
            -webkit-font-smoothing: antialiased;
            font-size: 1rem;
            font-weight: 400;
            opacity: 1;
            transition: opacity 0.3s ease;
            overflow-x: hidden;
        }

            /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--background);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-container {
            text-align: center;
            max-width: 500px;
            padding: 2rem;
        }

        .loading-logo {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.5rem;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .loading-subtext {
            font-size: 1.1rem;
            color: var(--secondary);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(26, 115, 232, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .loading-dots span {
            width: 10px;
            height: 10px;
            background: var(--primary);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
        .loading-dots span:nth-child(3) { animation-delay: 0s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); opacity: 0.3; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Main content always visible from the start */
        .main-content {
            opacity: 1;
            visibility: visible;
            display: block;
        }

        /* ===== NEW HEADER STYLES ===== */
        .app-header {
            background: var(--card-bg);
            border-bottom: 1px solid var(--border);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            text-decoration: none;
            color: var(--text);
        }

        .logo-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            color: var(--primary);
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
        }

        .main-nav {
            display: flex;
            gap: 1.5rem;
        }

        .nav-link {
            padding: 0.5rem 0;
            color: var(--secondary);
            text-decoration: none;
            font-weight: 500;
            position: relative;
            transition: color 0.2s ease;
        }

        .nav-link:hover {
            color: var(--text);
        }

        .nav-link.active {
            color: var(--primary);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
            border-radius: 2px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .header-btn:hover {
            background: var(--primary-dark);
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 6px;
            background: transparent;
            color: var(--secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .icon-btn:hover {
            background: var(--light);
            color: var(--text);
        }

        /* Mobile-only zoom controls */
        .mobile-only {
            display: none;
        }
        
        /* ============================================
   FORCE BOLDEN HEADER TEXT - FIX
   ============================================ */

/* Make CATrend Analyzer logo bolder */
.header-left .logo .logo-text {
    font-weight: 900 !important;
}

/* Make navigation links bolder */
.header-left .main-nav .nav-link {
    font-weight: 700 !important;
}

/* Make active navigation link extra bold */
.header-left .main-nav .nav-link.active {
    font-weight: 800 !important;
}

/* Make zoom percentage (90%) bolder */
.header-right .zoom-controls .zoom-level,
.header-right .mobile-only .zoom-level {
    font-weight: 800 !important;
    font-size: 0.95rem !important;
}

/* Make sure mobile zoom controls show the bold text */
.mobile-only .zoom-level {
    font-weight: 800 !important;
}

/* Also bold the theme toggle button text if needed */
.icon-btn[title*="Toggle theme"],
.icon-btn[title*="Switch"] {
    font-weight: 600 !important;
}

        /* Main Content Area */
        .main-content-area {
            max-width: 1200px;
            margin: 2.5rem auto;
            padding: 0 1.5rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== NEW HERO STYLES ===== */
        .hero-section {
            background: var(--background);
            padding: 4rem 0;
            position: relative;
        }

        .hero-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .hero-content {
            max-width: 600px;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            color: var(--text);
            line-height: 1.1;
            margin-bottom: 1.5rem;
            letter-spacing: -0.02em;
        }

        .hero-subtitle {
            display: block;
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--primary);
            margin-top: 0.5rem;
        }

        .hero-description {
            font-size: 1.125rem;
            line-height: 1.6;
            color: var(--secondary);
            margin-bottom: 2rem;
        }

        .hero-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
        }

       .btn-primary {
    padding: 1rem 2rem;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
}

.btn-primary:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 6px 16px rgba(26, 115, 232, 0.3);
}

/* Dangling Heart Animation */
.dangling-heart {
    display: inline-block;
    animation: dangle 2s ease-in-out infinite;
    transform-origin: top center;
    position: relative;
    cursor: pointer;
    color: #e25555;
}

@keyframes dangle {
    0%, 100% {
        transform: rotate(0deg);
    }
    25% {
        transform: rotate(10deg);
    }
    50% {
        transform: rotate(-10deg);
    }
    75% {
        transform: rotate(5deg);
    }
}

.dangling-heart:hover {
    animation: dangleFast 0.5s ease-in-out infinite;
    color: #ff6b6b;
    text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
}

@keyframes dangleFast {
    0%, 100% {
        transform: rotate(0deg) scale(1.2);
    }
    25% {
        transform: rotate(15deg) scale(1.2);
    }
    50% {
        transform: rotate(-15deg) scale(1.2);
    }
    75% {
        transform: rotate(10deg) scale(1.2);
    }
}

/* Add a subtle pulse effect on hover */
.dangling-heart::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 40px;
    height: 40px;
    background: radial-gradient(circle, rgba(255, 107, 107, 0.2) 0%, transparent 70%);
    border-radius: 50%;
    transform: translate(-50%, -50%) scale(0);
    transition: transform 0.3s ease;
    z-index: -1;
}

.dangling-heart:hover::after {
    transform: translate(-50%, -50%) scale(1);
}

/* Mobile adjustment for the dangling heart */
@media (max-width: 768px) {
    .dangling-heart {
        font-size: 1.1em;
    }
    
    .copyright p {
        line-height: 1.6;
    }
}

/* Add shine effect for primary button */
.btn-primary::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.2), 
        transparent);
    transition: left 0.5s ease;
}

.btn-primary:hover::after {
    left: 100%;
}

/* Add pulse animation for the icon */
.btn-primary:hover i {
    animation: pulse 0.5s ease;
}

/* Update dark theme primary button */
[data-theme="dark"] .btn-primary:hover {
    background: var(--primary);
    color: white;
    box-shadow: 0 6px 16px rgba(26, 115, 232, 0.3);
}

[data-theme="dark"] .btn-primary::after {
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.1), 
        transparent);
}

        .btn-secondary {
            padding: 1rem 2rem;
            background: transparent;
            color: var(--text);
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .hero-stats {
            display: flex;
            gap: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--secondary);
            font-weight: 500;
        }

        /* HERO VISUAL - UPDATED FOR DYNAMIC CONTENT */
        .hero-visual {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            max-height: 600px;
            overflow-y: auto;
        }

        .visual-container {
            width: 100%;
            min-width: 0; /* Allows shrinking */
        }

        .chart-demo {
            width: 100%;
            min-width: 0;
        }

        .chart-header {
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .chart-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.25rem;
        }

        .chart-subtitle {
            font-size: 0.875rem;
            color: var(--secondary);
        }

        /* Updated Trend Visualization for Dynamic Content */
        .trend-demo {
            position: relative;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--light);
            border-radius: 8px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            overflow-x: auto;
        }

        .trend-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 2.5rem;
            padding: 0 0.5rem;
            min-width: min-content;
        }

        .trend-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
            text-align: center;
            flex: 1;
            min-width: 80px;
            padding: 0 0.5rem;
        }

        .trend-line-container {
            position: relative;
            height: 200px;
            margin: 1rem 1.5rem;
            border-left: 2px solid var(--border);
            border-bottom: 2px solid var(--border);
            min-width: 400px;
        }

        .trend-line {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .trend-line-path {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
            transform-origin: left center;
            z-index: 1;
            transition: transform 0.5s ease;
        }

        .data-point {
            position: absolute;
            width: 16px;
            height: 16px;
            background: var(--success);
            border: 3px solid var(--card-bg);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .data-point:hover {
            transform: translate(-50%, -50%) scale(1.3);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .data-point:hover .point-tooltip {
            opacity: 1;
            transform: translate(-50%, -10px);
        }

        .point-tooltip {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-bg);
            color: var(--text);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border: 1px solid var(--border);
            z-index: 3;
        }

        .point-tooltip::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid var(--card-bg);
        }

        .y-axis-labels {
            position: absolute;
            left: -2rem;
            top: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .y-label {
            font-size: 0.8rem;
            color: var(--secondary);
            font-weight: 500;
        }

        .trend-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stat-card {
            flex: 1;
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border);
            transition: transform 0.3s ease;
            min-width: 120px;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stat-title {
            font-size: 0.9rem;
            color: var(--secondary);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        .trend-legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text);
            font-weight: 500;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .legend-color.success {
            background: var(--success);
        }

        .legend-color.trend {
            background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
        }

        .table-preview {
            margin-top: 2rem;
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--border);
            overflow-x: auto;
        }

        .preview-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1rem;
            text-align: center;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            min-width: 400px;
        }

        .preview-table th {
            background: var(--card-bg);
            color: var(--text);
            font-weight: 600;
            padding: 0.75rem;
            border: 1px solid var(--border);
            text-align: center;
            min-width: 80px;
        }

        .preview-table td {
            padding: 0.75rem;
            border: 1px solid var(--border);
            text-align: center;
            color: var(--text);
            min-width: 80px;
        }

        .preview-table .row-header {
            background: var(--card-bg);
            font-weight: 600;
            text-align: left;
            padding-left: 1rem;
        }

        .preview-table .total-row td {
            background: var(--primary-light);
            font-weight: 600;
        }

        .preview-table .total-row .row-header {
            background: var(--primary-light);
        }

        /* Reset Button for Hero Visualization */
        .reset-visualization {
            text-align: center;
            margin-top: 1.5rem;
        }

        .reset-btn {
            padding: 0.75rem 1.5rem;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
        }

        .reset-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: 0.75rem;
            border: 1px solid var(--border);
            padding: 2.25rem;
            margin-bottom: 2.25rem;
            box-shadow: var(--shadow);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1.75rem;
            display: flex;
            align-items: center;
            gap: 0.875rem;
        }

        .card-title i {
            color: var(--primary);
            font-size: 1.625rem;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.75rem;
            margin: 2.25rem 0;
        }

        .feature-item {
            padding: 1.75rem;
            border-radius: 0.625rem;
            border: 1px solid var(--border);
            background: var(--card-bg);
            transition: all 0.2s ease;
        }

        .feature-item:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .feature-icon {
            font-size: 2.25rem;
            color: var(--primary);
            margin-bottom: 1.25rem;
        }

        .feature-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.875rem;
        }

        .feature-desc {
            font-size: 1rem;
            font-weight: 500;
            color: var(--secondary);
            line-height: 1.7;
        }

        /* Table Controls */
        .table-controls {
            display: flex;
            gap: 1.25rem;
            margin-bottom: 1.75rem;
            flex-wrap: wrap;
            background: var(--light);
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border);
        }

        .control-group {
            flex: 1;
            min-width: 300px;
        }

        .group-title {
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 0.03125em;
            margin-bottom: 1.25rem;
        }

        .button-group {
            display: flex;
            gap: 0.875rem;
            margin-bottom: 1.25rem;
        }

  /* Button styles */
.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 0.5rem;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.625rem;
    background: var(--card-bg);
    border: 2px solid var(--border);
    color: var(--text);
    position: relative;
    overflow: hidden;
}

.btn:hover {
    background: var(--card-bg);
    border-color: var(--border);
    color: var(--text);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.btn-success {
    background: var(--success);
    color: white;
    border-color: var(--success);
}

.btn-success:hover {
    background: var(--success);
    color: white;
    border-color: var(--success);
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 6px 16px rgba(52, 168, 83, 0.3);
}

.btn-danger {
    background: var(--danger);
    color: white;
    border-color: var(--danger);
}

.btn-danger:hover {
    background: var(--danger);
    color: white;
    border-color: var(--danger);
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 6px 16px rgba(234, 67, 53, 0.3);
}

/* Add a subtle shine effect on hover */
.btn-success::after,
.btn-danger::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.2), 
        transparent);
    transition: left 0.5s ease;
}

.btn-success:hover::after,
.btn-danger:hover::after {
    left: 100%;
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none !important;
    box-shadow: none !important;
}

.btn:disabled:hover {
    background: var(--card-bg);
    border-color: var(--border);
    color: var(--text);
    transform: none !important;
}

/* For success and danger buttons when disabled */
.btn-success:disabled:hover {
    background: var(--success);
    border-color: var(--success);
    color: white;
    transform: none !important;
    box-shadow: none !important;
}

.btn-success:disabled:hover::after,
.btn-danger:disabled:hover::after {
    left: -100%;
}

.btn-danger:disabled:hover {
    background: var(--danger);
    border-color: var(--danger);
    color: white;
    transform: none !important;
    box-shadow: none !important;
}

/* Add a subtle pulse animation for the icons */
.btn-success:hover i,
.btn-danger:hover i {
    animation: pulse 0.5s ease;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

/* Update dark theme button colors */
[data-theme="dark"] .btn-success:hover {
    background: var(--success);
    color: white;
    border-color: var(--success);
    box-shadow: 0 6px 16px rgba(81, 199, 113, 0.4);
}

[data-theme="dark"] .btn-danger:hover {
    background: var(--danger);
    color: white;
    border-color: var(--danger);
    box-shadow: 0 6px 16px rgba(242, 139, 130, 0.4);
}

/* Adjust shine effect for dark theme */
[data-theme="dark"] .btn-success::after,
[data-theme="dark"] .btn-danger::after {
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.1), 
        transparent);
}

        /* Header Inputs */
        .header-inputs {
            display: flex;
            gap: 1.75rem;
            margin-bottom: 1.75rem;
            flex-wrap: wrap;
        }

        .header-group {
            flex: 1;
            min-width: 320px;
        }

        .header-group-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.625rem;
        }

        .header-input {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text);
            background: var(--card-bg);
            transition: border-color 0.2s ease;
        }

        .header-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(138, 180, 248, 0.1);
        }

        /* Table Container */
        .table-container {
            background: var(--card-bg);
            border-radius: 0.75rem;
            border: 1px solid var(--border);
            padding: 1.75rem;
            margin-top: 1.75rem;
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .data-table th {
            background: var(--light);
            color: var(--secondary);
            font-weight: 700;
            font-size: 1rem;
            padding: 1.125rem;
            text-align: center;
            border-bottom: 2px solid var(--border);
            min-width: 100px;
        }

        .data-table td {
            padding: 1.125rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
            font-weight: 500;
            min-width: 100px;
        }

        .data-table input {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text);
            text-align: center;
            background: var(--card-bg);
            transition: all 0.2s ease;
        }

        .data-table input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(138, 180, 248, 0.1);
        }

        .total-cell {
            background: var(--light);
            font-weight: 700;
            color: var(--text);
        }
        
        /* Reduce font size for statistic values in hero visualization */
.trend-stats .stat-value {
    font-size: 1.25rem !important; /* Reduced from 1.5rem */
    font-weight: 700;
}

/* Make the trend value a bit smaller since it's just text */
.trend-stats .stat-value.trend-up,
.trend-stats .stat-value.trend-down {
    font-size: 1.1rem !important;
}

        /* Analysis Controls */
        .analysis-controls {
            display: flex;
            gap: 1.75rem;
            margin: 2.25rem 0;
            flex-wrap: wrap;
        }

        .analysis-group {
            flex: 1;
            min-width: 320px;
            background: var(--light);
            padding: 1.75rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border);
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 1.125rem;
            margin-top: 1.25rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.875rem;
            cursor: pointer;
            font-weight: 500;
        }

        .radio-option input[type="radio"] {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: var(--primary);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 0.875rem;
            margin-top: 1.25rem;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 0.875rem;
            cursor: pointer;
            font-weight: 500;
        }

        .checkbox-option input[type="checkbox"] {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: var(--primary);
        }

        /* Run Analysis Button */
        .run-analysis {
            text-align: center;
            margin: 2.25rem 0;
        }

        .run-btn {
            padding: 1.125rem 3.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 0.625rem;
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.875rem;
        }

        .run-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* Chart Container */
        .chart-container {
            background: var(--card-bg);
            padding: 1.75rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border);
            margin: 2.25rem 0;
            height: 500px;
            position: relative;
        }

        /* Results Section */
        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.75rem;
            margin: 2.25rem 0;
        }

        .result-item {
            background: var(--card-bg);
            padding: 1.75rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border);
        }

        .stat-box {
            background: var(--light);
            padding: 1.75rem;
            border-radius: 0.625rem;
            margin-bottom: 1.25rem;
            text-align: center;
        }

        .stat-value {
            font-size: 2.625rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 0.75rem;
        }

        .stat-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--secondary);
        }
        
                /* Mobile SEO Optimization */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }
            .feature-name {
                font-size: 1.2rem;
            }
        }

        /* Significance Box */
        .significance-box {
            padding: 1.75rem;
            border-radius: 0.75rem;
            margin: 2.25rem 0;
        }

        .significance-box.significant {
            background: rgba(52, 168, 83, 0.1);
            border: 2px solid var(--success);
        }

        .significance-box.not-significant {
            background: rgba(234, 67, 53, 0.1);
            border: 2px solid var(--danger);
        }

        .significance-content {
            display: flex;
            align-items: center;
            gap: 1.25rem;
        }

        .significance-icon {
            font-size: 2.25rem;
        }

        .significance-text {
            flex: 1;
        }

        .significance-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.625rem;
        }

        /* Interpretation */
        .interpretation {
            background: rgba(138, 180, 248, 0.1);
            padding: 1.75rem;
            border-radius: 0.75rem;
            margin: 2.25rem 0;
            border: 2px solid rgba(138, 180, 248, 0.3);
        }

        .interpretation-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.875rem;
        }

        /* Export Section */
        .export-section {
            text-align: center;
            padding: 2.25rem;
            background: var(--light);
            border-radius: 0.75rem;
            border: 1px solid var(--border);
            margin: 2.25rem 0;
        }

        .export-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1.25rem;
        }

        .export-desc {
            font-size: 1rem;
            font-weight: 500;
            color: var(--secondary);
            margin-bottom: 1.75rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .export-btn {
            padding: 1.125rem 3rem;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 0.625rem;
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.875rem;
        }

        .export-btn:hover {
            opacity: 0.9;
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* Citation Section */
        .citation-section {
            background: var(--light);
            padding: 1.75rem;
            border-radius: 0.75rem;
            margin: 2.25rem 0;
            border: 1px solid var(--border);
        }

        .citation-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.875rem;
        }

        .citation-box {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 0.625rem;
            border: 1px solid var(--border);
            font-family: 'Times New Roman', serif;
            font-size: 1rem;
            font-weight: 500;
            line-height: 1.8;
            margin: 1.25rem 0;
        }

        /* Footer - FIXED: No bouncing */
        .main-footer {
            background: var(--background);
            border-top: 1px solid var(--border);
            padding: 3rem 0;
            margin-top: 4.5rem;
            width: 100%;
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            text-align: center;
        }

        .developer-info {
            margin-bottom: 1.75rem;
        }

        .developer-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.75rem;
        }

        .developer-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--secondary);
            margin-bottom: 1.25rem;
        }

        .contact-info {
            margin: 1.5rem 0;
        }

        .contact-email {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary);
            text-decoration: none;
            display: inline-block;
            margin: 0.75rem 0;
        }

        .contact-email:hover {
            text-decoration: underline;
        }

        .copyright {
            font-size: 1rem;
            font-weight: 500;
            color: var(--secondary);
            margin-top: 1.75rem;
            padding-top: 1.75rem;
            border-top: 1px solid var(--border);
        }

        /* Formula Box */
        .formula-box {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 0.625rem;
            margin: 1.75rem 0;
            text-align: center;
            font-family: 'Cambria Math', serif;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
            border: 2px solid var(--border);
        }

        /* References Box */
        .references-box {
            background: var(--light);
            padding: 1.75rem;
            border-radius: 0.75rem;
            margin: 2.25rem 0;
            border: 2px solid var(--border);
        }

        .references-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.875rem;
        }

        .reference-item {
            background: var(--card-bg);
            padding: 1.25rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            border: 1px solid var(--border);
            font-size: 0.9375rem;
            line-height: 1.7;
        }

        .reference-item strong {
            color: var(--text);
            font-weight: 600;
        }
        
        /* Add to the style section */
.fullscreen-control-btn {
    position: relative;
    overflow: hidden;
}

.fullscreen-control-btn::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.2), 
        transparent);
    transition: left 0.5s ease;
}

.fullscreen-control-btn:hover::after {
    left: 100%;
}

#closeFullscreenBtn::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.2), 
        transparent);
    transition: left 0.5s ease;
    border-radius: 6px;
}

#closeFullscreenBtn:hover::after {
    left: 100%;
}

        /* Alert Messages */
        .alert {
            padding: 1.25rem;
            border-radius: 0.625rem;
            margin: 1.25rem 0;
            display: flex;
            align-items: center;
            gap: 0.875rem;
            font-size: 1rem;
            font-weight: 500;
        }

        .alert-info {
            background: rgba(138, 180, 248, 0.1);
            border: 2px solid rgba(138, 180, 248, 0.3);
            color: var(--primary);
        }

        .alert-warning {
            background: rgba(249, 171, 0, 0.1);
            border: 2px solid rgba(249, 171, 0, 0.3);
            color: var(--warning);
        }
        
                /* GitHub Button Styles */
        .btn-github {
            background: #24292e;
            color: white;
            border: 2px solid #24292e;
        }
        
        .btn-github:hover {
            background: #444d56;
            border-color: #444d56;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(36, 41, 46, 0.3);
        }
        
        .btn-github::after {
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.1), 
                transparent);
        }
        
        /* Google Scholar Button Styles */
        .btn-scholar {
            background: #4285f4;
            color: white;
            border: 2px solid #4285f4;
        }
        
        .btn-scholar:hover {
            background: #3367d6;
            border-color: #3367d6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(66, 133, 244, 0.3);
        }
        
        .btn-scholar::after {
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
        }
        
        /* Fullscreen Modal Styles */
#fullscreenModal {
    backdrop-filter: none;
    transition: opacity 0.3s ease;
    background: white !important;
}

#fullscreenModal canvas {
    width: 100% !important;
    height: 100% !important;
    cursor: move;
    transition: transform 0.2s ease;
    background: white !important;
}

.fullscreen-control-btn:hover {
    background: var(--primary-dark) !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 16px rgba(26, 115, 232, 0.4) !important;
}

.fullscreen-control-btn:active {
    transform: translateY(0) !important;
    box-shadow: 0 2px 8px rgba(26, 115, 232, 0.3) !important;
}

#closeFullscreenBtn:hover {
    background: var(--primary-dark) !important;
    transform: scale(1.1) !important;
    box-shadow: 0 6px 16px rgba(26, 115, 232, 0.4) !important;
}

/* Ensure chart background is white in fullscreen */
#fullscreenChart {
    background-color: white !important;
}

        /* Tutorial Steps */
        .tutorial-steps {
            margin: 1.75rem 0;
            counter-reset: step-counter;
        }

        .tutorial-step {
            margin-bottom: 1.25rem;
            padding-left: 3.125rem;
            position: relative;
        }

        .tutorial-step::before {
            counter-increment: step-counter;
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            width: 2.25rem;
            height: 2.25rem;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Code Block */
        .code-block {
            background: var(--dark);
            color: #e1e4e8;
            padding: 1.5rem;
            border-radius: 0.5rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
            margin: 1.25rem 0;
            overflow-x: auto;
        }

        /* Zoom Controls */
        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--light);
            padding: 0.5rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
        }

        .zoom-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 0.375rem;
            background: var(--card-bg);
            color: var(--secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .zoom-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        .zoom-level {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text);
            min-width: 45px;
            text-align: center;
        }

        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
        }

        .theme-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: var(--card-bg);
            color: var(--secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }

        .theme-btn:hover {
            background: var(--primary);
            color: white;
            transform: rotate(30deg);
        }

        /* Update Chart.js colors based on theme */
        .chart-container canvas {
            background-color: var(--chart-bg) !important;
        }

        /* Fix code block for dark theme */
        [data-theme="dark"] .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            border: 1px solid #404040;
        }

        /* Fix loading screen for dark theme */
        [data-theme="dark"] .loading-screen {
            background: var(--background);
        }

        [data-theme="dark"] .loading-text {
            color: var(--text);
        }

        [data-theme="dark"] .loading-subtext {
            color: var(--secondary);
        }

        /* Fix alert colors for dark theme */
        [data-theme="dark"] .alert-info {
            background: rgba(138, 180, 248, 0.15);
            border-color: rgba(138, 180, 248, 0.3);
        }

        [data-theme="dark"] .alert-warning {
            background: rgba(251, 188, 4, 0.15);
            border-color: rgba(251, 188, 4, 0.3);
        }

        /* Fix formula box for dark theme */
        [data-theme="dark"] .formula-box {
            background: #292a2d;
            border-color: #5f6368;
            color: var(--text);
        }

        /* Fix data table inputs for dark theme */
        [data-theme="dark"] .data-table input {
            background: #202124;
            color: var(--text);
            border-color: var(--border);
        }

        [data-theme="dark"] .data-table input:focus {
            background: #292a2d;
        }

        /* Update zoom controls for dark theme */
        [data-theme="dark"] .zoom-controls {
            background: #292a2d;
            border-color: #5f6368;
        }

        [data-theme="dark"] .zoom-btn {
            background: #202124;
            color: var(--secondary);
        }

        [data-theme="dark"] .zoom-btn:hover {
            background: var(--primary);
            color: white;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 1024px) {
            .hero-container {
                grid-template-columns: 1fr;
                gap: 3rem;
            }
            
            .hero-content {
                max-width: 100%;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            /* Mobile hamburger menu */
            .main-nav {
                position: fixed;
                top: 64px;
                left: 0;
                right: 0;
                background: var(--card-bg);
                flex-direction: column;
                padding: 1rem;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                transform: translateY(-100%);
                opacity: 0;
                transition: transform 0.3s ease, opacity 0.3s ease;
                z-index: 999;
            }
            
            .main-nav.active {
                transform: translateY(0);
                opacity: 1;
            }
            
            .nav-link {
                padding: 1rem;
                border-bottom: 1px solid var(--border);
            }
            
            .nav-link.active::after {
                display: none;
            }
            
            .hamburger-menu {
                display: flex !important;
            }
        }

        @media (max-width: 768px) {
            html {
                font-size: 14px;
            }
            
            .header-container {
                padding: 0 1rem;
            }
            
            .hero-container {
                padding: 0 1rem;
            }
            
            .hero-title {
                font-size: 2rem;
            }
            
            .hero-actions {
                flex-direction: column;
            }
            
            .hero-stats {
                justify-content: center;
            }
            
            .trend-labels {
                gap: 0.5rem;
            }
            
            .trend-label {
                min-width: 60px;
                font-size: 0.8rem;
            }
            
            .mobile-only {
                display: flex;
            }
            
            .header-right {
                gap: 0.5rem;
            }
            
            .zoom-controls.mobile-only {
                position: static;
                background: transparent;
                box-shadow: none;
                padding: 0;
            }
            
            .zoom-controls.mobile-only .zoom-btn {
                width: 32px;
                height: 32px;
                font-size: 0.75rem;
            }
            
            .zoom-controls.mobile-only .zoom-level {
                min-width: 40px;
                font-size: 0.75rem;
            }
            
            .table-controls {
                flex-direction: column;
            }
            
            .control-group {
                min-width: 100%;
            }
            
            .data-table th,
            .data-table td {
                padding: 1rem;
            }
            
            .chart-container {
                height: 400px;
            }
            
            .theme-toggle {
                position: fixed;
                bottom: 5rem;
                right: 1rem;
                z-index: 1000;
            }
            
            .theme-btn {
                width: 44px;
                height: 44px;
                background: rgba(41, 42, 45, 0.95);
                backdrop-filter: blur(10px);
            }
        }

        @media (max-width: 480px) {
            html {
                font-size: 13px;
            }
            
            .hero-title {
                font-size: 1.75rem;
            }
            
            .hero-description {
                font-size: 1rem;
            }
            
            .trend-line-container {
                margin: 1rem;
                min-width: 300px;
            }
            
            .trend-label {
                min-width: 50px;
                font-size: 0.7rem;
            }
            
            .card-title {
                font-size: 1.375rem;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .stat-value {
                font-size: 2.25rem;
            }
            
            .chart-container {
                height: 350px;
            }
            
            .loading-text {
                font-size: 1.5rem;
            }
            
            .loading-subtext {
                font-size: 1rem;
            }
            
            .trend-stats {
                flex-direction: column;
            }
            
            .stat-card {
                min-width: 100%;
            }
        }

        @media (min-width: 1200px) {
            .main-content-area {
                padding: 0 2rem;
            }
        }
        
        /* Hamburger Menu */
        .hamburger-menu {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 21px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            z-index: 1000;
        }
        
        .hamburger-menu span {
            width: 100%;
            height: 3px;
            background: var(--text);
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .hamburger-menu.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }
        
        .hamburger-menu.active span:nth-child(2) {
            opacity: 0;
        }
        
        .hamburger-menu.active span:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }
        
        /* Enhanced Table Styles */
        .table-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            border: 1px solid var(--border);
        }
        
        .table-section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .table-section-title i {
            color: var(--primary);
        }
        
        .table-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .table-card {
            background: var(--light);
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }
        
        .table-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .table-card-content {
            font-size: 0.95rem;
            color: var(--secondary);
            line-height: 1.6;
        }
        
        .table-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        
        .table-action-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .table-action-btn.primary {
            background: var(--primary);
            color: white;
        }
        
        .table-action-btn.secondary {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text);
        }
        
        .table-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        /* Enhanced Results Export */
        .export-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .export-option {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.2s ease;
        }
        
        .export-option:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }
        
        .export-icon {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .export-option-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.5rem;
        }
        
        .export-option-desc {
            font-size: 0.9rem;
            color: var(--secondary);
            margin-bottom: 1rem;
        }
        
        /* Chi-square Test Highlight */
        .chi-square-highlight {
            background: linear-gradient(135deg, rgba(138, 180, 248, 0.1), rgba(234, 67, 53, 0.1));
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        
        .chi-square-highlight-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .chi-square-highlight-title i {
            color: var(--warning);
        }
        
        .chi-square-value {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--warning);
            margin-right: 0.5rem;
        }
        
        .chi-square-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
        }
        
        .chi-square-comparison {
            font-size: 0.9rem;
            color: var(--secondary);
            margin-top: 0.5rem;
        }
        
        /* Expected Cell Counts Table */
        .expected-table-container {
            background: var(--light);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border);
        }
        
        .expected-table-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .percentage-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .percentage-table th {
            background: var(--card-bg);
            color: var(--secondary);
            font-weight: 600;
            padding: 1rem;
            text-align: center;
            border: 1px solid var(--border);
        }
        
        .percentage-table td {
            padding: 1rem;
            text-align: center;
            border: 1px solid var(--border);
            color: var(--text);
        }
        
        .percentage-table .percentage-value {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Enhanced Statistical Results */
        .enhanced-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .enhanced-stat-card {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--border);
        }
        
        .enhanced-stat-card-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .enhanced-stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--text);
            margin-bottom: 0.25rem;
        }
        
        .enhanced-stat-value.highlight {
            color: var(--primary);
        }
        
        .enhanced-stat-description {
            font-size: 0.85rem;
            color: var(--secondary);
            line-height: 1.4;
        }
        
        /* Test Configuration Options */
        .test-configuration {
            background: var(--light);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border);
        }
        
        .test-config-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .test-config-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .test-config-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .test-config-option input[type="radio"] {
            width: 18px;
            height: 18px;
        }
        
        .test-config-option label {
            font-weight: 500;
            color: var(--text);
            cursor: pointer;
        }
        
        .test-config-option .config-help {
            font-size: 0.8rem;
            color: var(--secondary);
            margin-left: 0.5rem;
        }
        
        /* Responsive adjustments for new elements */
        @media (max-width: 768px) {
            .table-grid,
            .export-options,
            .enhanced-results {
                grid-template-columns: 1fr;
            }
            
            .table-actions {
                flex-direction: column;
            }
            
            .table-action-btn {
                width: 100%;
                justify-content: center;
            }
            
            .percentage-table th,
            .percentage-table td {
                padding: 0.75rem;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
  
      <!-- Add this wrapper div for better scroll control -->
    <div class="page-wrapper">
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-logo">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="loading-text">CATrend Analyzer</div>
            <div class="loading-subtext">Open-Source Cochran–Armitage Trend Test (CATT) Web-Based Software</div>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- New Clean Header -->
        <header class="app-header">
            <div class="header-container">
                <div class="header-left">
                    <button class="hamburger-menu" id="hamburgerMenu">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    <div class="logo" onclick="showSection('home')">
                        <div class="logo-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <span class="logo-text">CATrend Analyzer</span>
                    </div>
                    <nav class="main-nav" id="mainNav">
                        <a href="#home" class="nav-link active" onclick="showSection('home'); return false;">Home</a>
                        <a href="#analysis" class="nav-link" onclick="showSection('analysis'); return false;">Analysis</a>
                        <a href="#documentation" class="nav-link" onclick="showSection('documentation'); return false;">Documentation</a>
                        <a href="#developer" class="nav-link" onclick="showSection('developer'); return false;">Developer</a>
                    </nav>
                </div>
                <div class="header-right">
                    <button class="icon-btn" id="themeToggleBtn" title="Toggle theme">
                        <i class="fas fa-moon" id="themeIcon"></i>
                    </button>
                    <!-- Zoom Controls for mobile -->
                    <div class="zoom-controls mobile-only">
                        <button class="zoom-btn" id="zoomOutBtn" title="Zoom Out">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="zoom-level" id="zoomLevel">90%</span>
                        <button class="zoom-btn" id="zoomInBtn" title="Zoom In">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content-area">
            <!-- Home Tab -->
            <section id="home" class="tab-content active">
                <!-- NEW HERO SECTION -->
                <section class="hero-section" id="home">
                    <div class="hero-container">
                        <div class="hero-content">
                            <h1 class="hero-title">
                                Cochran-Armitage Trend Test
                                <span class="hero-subtitle">Professional Statistical Analysis Software</span>
                            </h1>
                            <p class="hero-description">
                                <strong>The first web-based tool to combine:</strong> Cochran-Armitage trend analysis, interactive contingency tables, professional reporting, and data visualization in one intuitive interface. 
                                <span style="background: var(--primary-light); padding: 0.2rem 0.5rem; border-radius: 0.25rem; font-weight: 600;">
Free & open-source for clinical trials, epidemiology, and research.
                                </span>
                            </p>
                            <div class="hero-actions">
                                <button class="btn-primary" onclick="showSection('analysis'); return false;">
                                    <i class="fas fa-play-circle"></i>
                                    Start Analysis
                                </button>
                                <button class="btn-secondary" onclick="scrollToFeatures()">
                                    <i class="fas fa-info-circle"></i>
                                    Learn More
                                </button>
                            </div>
                            <div class="hero-stats">
                                <div class="stat-item">
                                    <div class="stat-number">100%</div>
                                    <div class="stat-label">Free</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number">Open</div>
                                    <div class="stat-label">Source</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number">No Signup</div>
                                    <div class="stat-label">Required</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- HERO VISUAL WITH DYNAMIC CONTENT -->
                        <div class="hero-visual" id="heroVisual">
                            <div class="visual-container">
                                <div class="chart-demo">
                                    <div class="chart-header">
                                        <div class="chart-title" id="chartTitle">Cochran-Armitage Trend Analysis</div>
                                        <div class="chart-subtitle" id="chartSubtitle">Increasing Success Rates Across Treatment Levels</div>
                                    </div>
                                    
                                    <!-- Trend visualization -->
                                    <div class="trend-demo" id="trendDemo">
                                        <!-- X-axis labels will be dynamically generated -->
                                        <div class="trend-labels" id="trendLabels">
                                            <!-- Default labels - will be replaced -->
                                            <div class="trend-label">Level 1</div>
                                            <div class="trend-label">Level 2</div>
                                            <div class="trend-label">Level 3</div>
                                            <div class="trend-label">Level 4</div>
                                        </div>
                                        
                                        <!-- Trend line with points -->
                                        <div class="trend-line-container" id="trendLineContainer">
                                            <div class="trend-line" id="trendLine">
                                                <!-- Success rate trend line -->
                                                <div class="trend-line-path" id="trendLinePath"></div>
                                                
                                                <!-- Data points will be dynamically generated -->
                                                <div class="data-point" style="left: 0%; top: 60%;" data-value="40%">
                                                    <div class="point-tooltip">Success: 40%</div>
                                                </div>
                                                <div class="data-point" style="left: 33%; top: 35%;" data-value="65%">
                                                    <div class="point-tooltip">Success: 65%</div>
                                                </div>
                                                <div class="data-point" style="left: 66%; top: 20%;" data-value="80%">
                                                    <div class="point-tooltip">Success: 80%</div>
                                                </div>
                                                <div class="data-point" style="left: 100%; top: 5%;" data-value="95%">
                                                    <div class="point-tooltip">Success: 95%</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Y-axis labels -->
                                        <div class="y-axis-labels">
                                            <div class="y-label">100%</div>
                                            <div class="y-label">75%</div>
                                            <div class="y-label">50%</div>
                                            <div class="y-label">25%</div>
                                            <div class="y-label">0%</div>
                                        </div>
                                        
                                        <!-- Statistics box -->
                                        <div class="trend-stats" id="trendStats">
                                            <div class="stat-card">
                                                <div class="stat-title">Z-statistic</div>
                                                <div class="stat-value" id="zStatValue">4.32</div>
                                            </div>
                                            <div class="stat-card">
                                                <div class="stat-title">P-value</div>
                                                <div class="stat-value" id="pValue">&lt;0.001</div>
                                            </div>
                                            <div class="stat-card">
                                                <div class="stat-title">Trend</div>
                                                <div class="stat-value trend-up" id="trendValue">Increasing</div>
                                            </div>
                                        </div>
                                        
                                        <!-- Legend -->
                                        <div class="trend-legend">
                                            <div class="legend-item">
                                                <div class="legend-color success"></div>
                                                <span>Success Rate</span>
                                            </div>
                                            <div class="legend-item">
                                                <div class="legend-color trend"></div>
                                                <span>Trend Line</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Contingency table preview -->
                                    <div class="table-preview">
                                        <div class="preview-title">Sample Contingency Table</div>
                                        <table class="preview-table" id="previewTable">
                                            <thead>
                                                <tr>
                                                    <th></th>
                                                    <th>Level 1</th>
                                                    <th>Level 2</th>
                                                    <th>Level 3</th>
                                                    <th>Level 4</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="row-header">Success</td>
                                                    <td>40</td>
                                                    <td>65</td>
                                                    <td>80</td>
                                                    <td>95</td>
                                                </tr>
                                                <tr>
                                                    <td class="row-header">Failure</td>
                                                    <td>60</td>
                                                    <td>35</td>
                                                    <td>20</td>
                                                    <td>5</td>
                                                </tr>
                                                <tr class="total-row">
                                                    <td class="row-header">Total</td>
                                                    <td>100</td>
                                                    <td>100</td>
                                                    <td>100</td>
                                                    <td>100</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Reset Button -->
                            <div class="reset-visualization">
                                <button class="reset-btn" id="resetVisualizationBtn">
                                    <i class="fas fa-redo"></i>
                                    Reset to Default
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Rest of the home content remains the same -->
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-info-circle"></i>
                        Understanding the Cochran-Armitage Trend Test
                    </h2>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                        What is the Cochran-Armitage Trend Test?
                    </h3>
                    <p style="color: var(--text); line-height: 1.7; margin-bottom: 1.25rem;">
                        The Cochran-Armitage Trend Test (CATT) is a statistical test used to detect trends in proportions 
                        across ordered categorical variables. It's particularly useful when you have a binary outcome 
                        (e.g., success/failure) and an ordered explanatory variable (e.g., treatment levels 1, 2, 3).
                    </p>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                        When is it Used?
                    </h3>
                    <p style="color: var(--text); line-height: 1.7; margin-bottom: 1.25rem;">
                        The test is commonly used in:
                    </p>
                    <ul style="color: var(--secondary); line-height: 1.8; padding-left: 1.5rem; margin-bottom: 1.25rem;">
                        <li><strong>Clinical Trials:</strong> Testing if treatment response increases with dosage levels</li>
                        <li><strong>Epidemiology:</strong> Analyzing disease incidence across age groups</li>
                        <li><strong>Public Health:</strong> Examining vaccination rates across socioeconomic strata</li>
                        <li><strong>Genetics:</strong> Testing genotype-phenotype associations</li>
                        <li><strong>Market Research:</strong> Analyzing preference trends across product variants</li>
                    </ul>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                        Key Assumptions
                    </h3>
                    <div class="alert alert-info">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>
                            <strong>Important Assumptions:</strong> 
                            <ul style="margin-top: 0.625rem;">
                                <li>Ordered categories (groups must have a natural ordering)</li>
                                <li>Independent observations</li>
                                <li>Binary outcome variable</li>
                                <li>Large enough sample size for normal approximation</li>
                                <li>Non-zero marginal totals</li>
                            </ul>
                        </div>
                    </div>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                        Statistical Formula
                    </h3>
                    <div class="formula-box">
                        Cochran-Armitage Trend Test Formula:
                        <br>
                        <strong>Z = Σ yⱼ(xⱼ - x̄) / √[p̄(1-p̄) Σ nⱼ(xⱼ - x̄)²]</strong>
                    </div>
                    
                    <div style="margin-top: 1.75rem;">
                        <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                            Where:
                        </h4>
                        <ul style="color: var(--secondary); line-height: 1.8; padding-left: 1.5rem; font-size: 1rem; font-weight: 500;">
                            <li><strong>xⱼ</strong> = scores for ordered groups (1, 2, 3, ...)</li>
                            <li><strong>yⱼ</strong> = success counts in each group</li>
                            <li><strong>nⱼ</strong> = total counts in each group</li>
                            <li><strong>x̄</strong> = weighted mean of scores: Σ(nⱼ·xⱼ)/N</li>
                            <li><strong>p̄</strong> = overall proportion of successes: Σyⱼ/N</li>
                            <li><strong>N</strong> = total sample size: Σnⱼ</li>
                        </ul>
                    </div>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-top: 1.875rem; margin-bottom: 1.25rem;">
                        Reference Article
                    </h3>
                    <div class="reference-item">
                        <strong>Cochran, W. G. (1954).</strong> "Some Methods for Strengthening the Common χ² Tests." 
                        <em>Biometrics, 10(4), 417-451.</em>
                        <br><br>
                        This seminal paper introduced the test for trend in proportions. Cochran demonstrated that 
                        the test statistic follows approximately a standard normal distribution under the null 
                        hypothesis of no trend. The test was further developed by Armitage (1955), who provided 
                        additional theoretical foundations and practical applications.
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-star"></i>
                        About CATrend Analyzer
                    </h2>
                    
                    <p style="color: var(--text); line-height: 1.7; margin-bottom: 1.5rem;">
                        <strong>CATrend Analyzer</strong> is an open-source web-based software designed to perform 
                        Cochran-Armitage Trend Test analysis. It provides researchers, statisticians, and students 
                        with an intuitive interface for analyzing trend data without requiring advanced statistical 
                        software or programming knowledge.
                    </p>
                    
                    <div class="features-grid">
                        <div class="feature-item">
                            <i class="fas fa-table feature-icon"></i>
                            <h3 class="feature-name">Interactive Contingency Tables</h3>
                            <p class="feature-desc">
                                Create and edit contingency tables with unlimited rows and columns. 
                                Dynamic table that adjusts automatically as you add data.
                            </p>
                        </div>
                        
                        <div class="feature-item">
                            <i class="fas fa-calculator feature-icon"></i>
                            <h3 class="feature-name">Accurate Statistical Analysis</h3>
                            <p class="feature-desc">
                                Real-time calculation of Cochran-Armitage test statistics, 
                                p-values, and significance levels using the exact formula.
                            </p>
                        </div>
                        
                        <div class="feature-item">
                            <i class="fas fa-chart-bar feature-icon"></i>
                            <h3 class="feature-name">Advanced Data Visualization</h3>
                            <p class="feature-desc">
                                Generate clustered bar charts with percentage labels. 
                                Choose between row percentages, column percentages, or raw counts.
                            </p>
                        </div>
                        
                        <div class="feature-item">
                            <i class="fas fa-file-word feature-icon"></i>
                            <h3 class="feature-name">Professional Reports</h3>
                            <p class="feature-desc">
                                Export complete analysis reports in Microsoft Word format 
                                with tables, results, interpretation, and visualizations.
                            </p>
                        </div>
                        
                        <div class="feature-item">
                            <i class="fas fa-lightbulb feature-icon"></i>
                            <h3 class="feature-name">Clear Interpretation</h3>
                            <p class="feature-desc">
                                Automatic generation of statistical interpretation with 
                                significance highlighting and practical implications.
                            </p>
                        </div>
                        
                        <div class="feature-item">
                            <i class="fas fa-graduation-cap feature-icon"></i>
                            <h3 class="feature-name">Educational Tool</h3>
                            <p class="feature-desc">
                                Perfect for teaching and learning trend test concepts. 
                                Includes detailed formulas and step-by-step explanations.
                            </p>
                        </div>
                    </div>
                </div>

                      <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-play-circle"></i>
                        How to Use CATrend Analyzer
                    </h2>
                    
                    <div class="alert alert-info" style="margin-bottom: 2rem;">
                        <i class="fas fa-lightbulb"></i>
                        <div>
                            <strong>Data Preparation Tip:</strong> Before using CATrend Analyzer, ensure your data is properly prepared in a contingency table format with ordered groups. You can generate this table from your raw data using statistical software like SPSS, R, Stata, or Excel.
                        </div>
                    </div>
                    
                    <div class="tutorial-steps">
                        <div class="tutorial-step">
                            <strong>Step 1: Prepare Your Contingency Table</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                From your original dataset, create a 2×k contingency table (2 rows × k columns) where:
                                <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                                    <li><strong>Row 1:</strong> Success/Event counts for each ordered group</li>
                                    <li><strong>Row 2:</strong> Failure/Non-event counts for each ordered group</li>
                                    <li><strong>Columns:</strong> Ordered categories (e.g., Age groups: 18-30, 31-45, 46-60, 61+)</li>
                                </ul>
                                Ensure your groups have a natural ordering (low to high, mild to severe, etc.).
                            </p>
                        </div>
                        
                        <div class="tutorial-step">
                            <strong>Step 2: Navigate to the Analysis Tab</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                Click on the "Analysis" tab in the navigation bar to access the main analysis interface.
                            </p>
                        </div>
                        
                        <div class="tutorial-step">
                            <strong>Step 3: Set Up Your Contingency Table</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                Enter your row and column headers. Rows typically represent binary outcomes (e.g., Success/Failure, Yes/No, Present/Absent), 
                                while columns represent ordered groups (e.g., Treatment doses: Low, Medium, High).
                            </p>
                        </div>
                        
                        <div class="tutorial-step">
                            <strong>Step 4: Enter Your Frequency Data</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                Input frequency counts (whole numbers) in the table cells. The table automatically calculates row totals, 
                                column totals, and grand totals as you enter data. Ensure all cells contain non-negative integers.
                            </p>
                        </div>
                        
                        <div class="tutorial-step">
                            <strong>Step 5: Configure Test Options</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                Choose your test type (two-sided or one-sided), and decide whether to apply continuity correction 
                                (recommended for small sample sizes with N < 100).
                            </p>
                        </div>
                        
                        <div class="tutorial-step">
                            <strong>Step 6: Run the Analysis</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                Click "Run Cochran-Armitage Test" to perform the statistical analysis. Results will appear 
                                automatically below with Z-statistic, p-value, and significance assessment.
                            </p>
                        </div>
                        
                        <div class="tutorial-step">
                            <strong>Step 7: Interpret Results</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                Review the statistical results, significance assessment, and automatic interpretation. 
                                Adjust visualization options as needed to display counts, row percentages, or column percentages.
                            </p>
                        </div>
                        
                        <div class="tutorial-step">
                            <strong>Step 8: Export Your Report</strong>
                            <p style="color: var(--secondary); margin-top: 0.5rem;">
                                Generate a professional Microsoft Word report with all analysis results, visualizations, 
                                tables, and proper citations for your research publication or documentation.
                            </p>
                        </div>
                    </div>
                    
                    <div style="background: var(--light); padding: 1.5rem; border-radius: 0.75rem; margin-top: 2rem; border: 2px solid var(--border);">
                        <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                            <i class="fas fa-database"></i>
                            Example Data Format
                        </h3>
                        <p style="color: var(--text); margin-bottom: 1rem; font-weight: 500;">
                            Your data should be formatted like this before entering it into CATrend Analyzer:
                        </p>
                        <div style="background: var(--card-bg); padding: 1rem; border-radius: 0.5rem; overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; min-width: 400px;">
                                <thead>
                                    <tr style="background: var(--light);">
                                        <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: center;"></th>
                                        <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: center; font-weight: 600;">Dose Level 1</th>
                                        <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: center; font-weight: 600;">Dose Level 2</th>
                                        <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: center; font-weight: 600;">Dose Level 3</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); font-weight: 600; background: var(--light);">Treatment Response</td>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); text-align: center;">25</td>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); text-align: center;">40</td>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); text-align: center;">55</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); font-weight: 600; background: var(--light);">No Response</td>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); text-align: center;">35</td>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); text-align: center;">20</td>
                                        <td style="padding: 0.75rem; border: 1px solid var(--border); text-align: center;">10</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p style="color: var(--secondary); margin-top: 1rem; font-size: 0.9rem;">
                            <i class="fas fa-info-circle" style="margin-right: 0.5rem;"></i>
                            This 2×3 table shows increasing treatment response rates across ordered dose levels.
                        </p>
                    </div>
                </div>

                <div class="alert alert-info" style="margin-bottom: 2.25rem;">
                    <i class="fas fa-lightbulb"></i>
                    <div>
                        <strong>Tip:</strong> For best results, ensure your data meets the test assumptions. 
                        If you have small sample sizes, consider using exact methods or consult with a statistician.
                    </div>
                </div>
            </section>

            <!-- Analysis Tab (Initially empty, will be populated by JavaScript) -->
            <section id="analysis" class="tab-content">
                <!-- Content will be generated by JavaScript -->
            </section>

            <!-- Documentation Tab -->
            <section id="documentation" class="tab-content">
                <div class="hero-section">
                    <h1 class="hero-title">Documentation & User Guide</h1>
                    <p class="hero-subtitle">
                        Comprehensive documentation for CATrend Analyzer - Understanding statistical methods, 
                        interpreting results, and troubleshooting common issues.
                    </p>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-book-open"></i>
                        Statistical Methodology Documentation
                    </h2>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                        Mathematical Foundation
                    </h3>
                    
                    <div class="formula-box">
                        <strong>Test Statistic Calculation:</strong><br>
                        Z = (Σ yⱼ(xⱼ - x̄)) / √[p̄(1-p̄) Σ nⱼ(xⱼ - x̄)²]
                    </div>
                    
                    <div style="margin-top: 1.75rem;">
                        <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                            Detailed Formula Explanation:
                        </h4>
                        <div class="code-block">
// Step-by-step calculation in pseudocode
1. Assign scores xⱼ = 1, 2, 3, ..., k
2. Calculate column totals: nⱼ = Σ row counts in column j
3. Calculate success counts: yⱼ = counts in "success" row
4. Calculate weighted mean: x̄ = Σ(nⱼ * xⱼ) / N
5. Calculate overall success proportion: p̄ = Σyⱼ / N
6. Calculate numerator: numerator = Σ yⱼ(xⱼ - x̄)
7. Calculate denominator: denominator = √[p̄(1-p̄) Σ nⱼ(xⱼ - x̄)²]
8. Calculate Z-statistic: Z = numerator / denominator
9. Apply continuity correction if selected: Z = (|numerator| - 0.5) / denominator
10. Calculate p-value from standard normal distribution
                        </div>
                    </div>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-top: 1.875rem; margin-bottom: 1.25rem;">
                        Statistical Interpretation Guidelines
                    </h3>
                    
                    <div style="background: var(--light); padding: 1.5rem; border-radius: 0.625rem; margin-bottom: 1.5rem;">
                        <h4 style="font-size: 1rem; font-weight: 700; color: var(--text); margin-bottom: 1rem;">
                            Significance Levels and Interpretation:
                        </h4>
                        <ul style="color: var(--text); line-height: 1.8;">
                            <li><strong>p &lt; 0.001:</strong> Highly significant trend</li>
                            <li><strong>p &lt; 0.01:</strong> Very significant trend</li>
                            <li><strong>p &lt; 0.05:</strong> Significant trend</li>
                            <li><strong>p ≥ 0.05:</strong> No significant trend detected</li>
                        </ul>
                    </div>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                        Continuity Correction
                    </h3>
                    <p style="color: var(--text); line-height: 1.7; margin-bottom: 1.25rem;">
                        The continuity correction (Yates' correction) adjusts the test statistic to account for 
                        the approximation of a discrete distribution with a continuous normal distribution. 
                        It's recommended for small sample sizes (N &lt; 100).
                    </p>
                    
                    <div class="formula-box">
                        With continuity correction:<br>
                        Z = (|Σ yⱼ(xⱼ - x̄)| - 0.5) / √[p̄(1-p̄) Σ nⱼ(xⱼ - x̄)²]
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-question-circle"></i>
                        Frequently Asked Questions
                    </h2>
                    
                    <div style="margin-top: 1.5rem;">
                        <h3 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 0.75rem;">
                            Q: What is the minimum sample size required?
                        </h3>
                        <p style="color: var(--secondary); margin-bottom: 1.5rem; line-height: 1.7;">
                            A: There is no strict minimum sample size for the Cochran–Armitage Trend Test. However, because it relies on the normal approximation, it works best when expected counts in each cell are not too small. A common rule of thumb is at least 20 observations per group, but this may vary depending on the number of groups and success rates. For smaller samples, exact methods or statistical consultation are recommended.
                        </p>
                        
                        <h3 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 0.75rem;">
                            Q: Can I use this test for more than two outcome categories?
                        </h3>
                        <p style="color: var(--secondary); margin-bottom: 1.5rem; line-height: 1.7;">
                            A: No. The Cochran–Armitage Trend Test is designed specifically for binary outcomes across ordered groups. If your outcome has more than two ordered categories, consider alternative tests such as the Jonckheere-Terpstra test or the linear-by-linear association test, which are suitable for ordinal outcomes with multiple categories.
                        </p>
                        
                        <h3 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 0.75rem;">
                            Q: What if my groups are not equally spaced?
                        </h3>
                        <p style="color: var(--secondary); margin-bottom: 1.5rem; line-height: 1.7;">
                            A: The Cochran–Armitage Trend Test allows you to assign custom scores (xⱼ) that reflect the actual spacing between groups. Most software, including CATrend Analyzer, defaults to equally spaced scores (1, 2, 3, …). If your groups are unequally spaced, you should provide custom scores. If the software does not allow this, you may need to calculate the test statistic manually.
                        </p>
                        
                        <h3 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 0.75rem;">
                            Q: How do I cite CATrend Analyzer in my research?
                        </h3>
                        <p style="color: var(--secondary); margin-bottom: 1.5rem; line-height: 1.7;">
                            A: Use the citation provided in the results section. To do this, simply open CATrend Analyzer in your browser, copy the URL from the address bar, and replace the placeholder with it so readers can access the exact tool you used in your analysis:<br>
                            Ibrahim, M. M. (2026). <em>CATrend Analyzer: Cochran-Armitage Trend Test Analysis Tool</em> 
                            [Computer software]. Retrieved from [website url]
                        </p>
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        Troubleshooting Common Issues
                    </h2>
                    
                    <div class="alert alert-warning" style="margin-bottom: 1.5rem;">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>
                            <strong>Zero Cells:</strong> If any cell contains zero, the test may still work, 
                            but interpret results with caution. Consider aggregating groups or using exact methods.
                        </div>
                    </div>
                    
                    <div class="alert alert-warning" style="margin-bottom: 1.5rem;">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>
                            <strong>Small Sample Sizes:</strong> For N &lt; 20, the normal approximation may not be valid. 
                            Consider using Fisher's exact test or consult a statistician.
                        </div>
                    </div>
                    
                    <div class="alert alert-warning" style="margin-bottom: 1.5rem;">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>
                            <strong>Missing Data:</strong> CATrend Analyzer requires complete contingency tables. 
                            Handle missing data appropriately before analysis.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Developer Tab -->
            <section id="developer" class="tab-content">
                <div class="hero-section">
                    <h1 class="hero-title">Developer Information</h1>
                    <p class="hero-subtitle">
                        Technical documentation for developers interested in contributing to CATrend Analyzer 
                        or understanding its implementation.
                    </p>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-code"></i>
                        Technical Architecture
                    </h2>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.25rem;">
                        Technology Stack
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.25rem; margin: 1.5rem 0;">
                        <div style="background: var(--light); padding: 1.25rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 2.25rem; color: var(--primary); margin-bottom: 0.75rem;">
                                <i class="fab fa-html5"></i>
                            </div>
                            <div style="font-weight: 700; color: var(--text);">HTML5</div>
                            <div style="color: var(--secondary); font-size: 0.875rem;">Semantic markup</div>
                        </div>
                        
                        <div style="background: var(--light); padding: 1.25rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 2.25rem; color: var(--primary); margin-bottom: 0.75rem;">
                                <i class="fab fa-css3-alt"></i>
                            </div>
                            <div style="font-weight: 700; color: var(--text);">CSS3</div>
                            <div style="color: var(--secondary); font-size: 0.875rem;">Custom properties, Flexbox</div>
                        </div>
                        
                        <div style="background: var(--light); padding: 1.25rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 2.25rem; color: var(--primary); margin-bottom: 0.75rem;">
                                <i class="fab fa-js"></i>
                            </div>
                            <div style="font-weight: 700; color: var(--text);">JavaScript</div>
                            <div style="color: var(--secondary); font-size: 0.875rem;">Vanilla JS, ES6+</div>
                        </div>
                        
                        <div style="background: var(--light); padding: 1.25rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 2.25rem; color: var(--primary); margin-bottom: 0.75rem;">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div style="font-weight: 700; color: var(--text);">Chart.js</div>
                            <div style="color: var(--secondary); font-size: 0.875rem;">Data visualization</div>
                        </div>
                    </div>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-top: 1.875rem; margin-bottom: 1.25rem;">
                        Core Algorithm Implementation
                    </h3>
                    
                    <div class="code-block">
// Cochran-Armitage test calculation function
function calculateCochranArmitage(data, options) {
    const { testType, continuityCorrection } = options;
    
    // Extract data
    const { rows, cols, tableData } = data;
    
    // Calculate totals
    const N = tableData.flat().reduce((sum, val) => sum + val, 0);
    const k = cols.length;
    
    // Assign scores (1, 2, 3, ...)
    const scores = Array.from({length: k}, (_, i) => i + 1);
    
    // Calculate column totals and success counts
    const columnTotals = Array(k).fill(0);
    const successCounts = Array(k).fill(0);
    
    for (let j = 0; j < k; j++) {
        for (let i = 0; i < rows.length; i++) {
            columnTotals[j] += tableData[i][j];
            if (i === 0) { // First row is "success"
                successCounts[j] += tableData[i][j];
            }
        }
    }
    
    // Calculate observed response probabilities
    const pj = yj.map((y, idx) => nj[idx] > 0 ? y / nj[idx] : 0);
    
    // Calculate weighted mean of scores
    const weightedMean = columnTotals.reduce((sum, n, idx) => 
        sum + n * scores[idx], 0) / N;
    
    // Calculate numerator: Σyj(xj - x̄)
    const numerator = successCounts.reduce((sum, y, idx) => 
        sum + y * (scores[idx] - weightedMean), 0);
    
    // Calculate overall proportion
    const overallProportion = successCounts.reduce((a, b) => a + b, 0) / N;
    
    // Calculate variance term
    const varianceTerm = overallProportion * (1 - overallProportion) * 
        columnTotals.reduce((sum, n, idx) => 
            sum + n * Math.pow(scores[idx] - weightedMean, 2), 0);
    
    // Apply continuity correction
    let correction = continuityCorrection ? 0.5 : 0;
    let zStatistic = (Math.abs(numerator) - correction) / Math.sqrt(varianceTerm);
    
    // Calculate p-value
    const pValue = calculatePValue(zStatistic, testType);
    
    // Calculate chi-square for association
    const chiSquareAssociation = calculateChiSquareAssociation(data);
    
    return {
        zStatistic,
        chiSquare: zStatistic * zStatistic,
        chiSquareAssociation,
        pValue,
        N,
        k,
        weightedMean,
        overallProportion,
        columnTotals,
        successCounts,
        degreesOfFreedom: (rows.length - 1) * (cols.length - 1)
    };
}
                    </div>
                </div>

                            <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-user-circle"></i>
                        About the Developer
                    </h2>
                        <div style="flex: 1; min-width: 300px;">
                            <p style="color: var(--text); line-height: 1.7; margin-bottom: 1.5rem; font-size: 1.1rem;">
                                My name is Mudasir Mohammed Ibrahim, and I am from Ghana.</strong> As a dedicated healthcare professional with a passion for data analysis and research methodology, I created CATrend Analyzer to bridge the gap between clinical practice and statistical analysis. My goal is to make advanced statistical tools accessible to healthcare professionals, researchers, and students without requiring extensive programming knowledge.
                            </p>
                            
                            <div style="background: var(--light); padding: 1.5rem; border-radius: 0.75rem; border-left: 4px solid var(--primary); margin-bottom: 1.5rem;">
                                <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                                    <i class="fas fa-graduation-cap"></i>
                                    Background & Expertise
                                </h4>
                                <ul style="color: var(--text); line-height: 1.7; padding-left: 1.5rem;">
                                    <li>Registered Nurse with clinical experience in multiple healthcare settings</li>
                                    <li>Health researcher focused on epidemiology and public health</li>
                                    <li>Statistical analysis and research methodology</li>
                                    <li>R programming and data visualization</li>
                                    <li>Open-source software development</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                        <div style="background: var(--light); padding: 1.5rem; border-radius: 0.75rem; border: 1px solid var(--border);">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                                <i class="fas fa-heartbeat"></i>
                                Healthcare Vision
                            </h4>
                            <p style="color: var(--text); line-height: 1.6;">
                                To improve healthcare outcomes through accessible data analysis tools that empower 
                                medical professionals to make evidence-based decisions.
                            </p>
                        </div>
                        
                        <div style="background: var(--light); padding: 1.5rem; border-radius: 0.75rem; border: 1px solid var(--border);">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                                <i class="fas fa-laptop-code"></i>
                                Technical Approach
                            </h4>
                            <p style="color: var(--text); line-height: 1.6;">
                                Developing user-friendly, open-source tools that implement rigorous statistical 
                                methods while maintaining clinical relevance and practical applicability.
                            </p>
                        </div>
                        
                        <div style="background: var(--light); padding: 1.5rem; border-radius: 0.75rem; border: 1px solid var(--border);">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                                <i class="fas fa-hands-helping"></i>
                                Community Impact
                            </h4>
                            <p style="color: var(--text); line-height: 1.6;">
                                Creating free resources that support healthcare research and education worldwide, 
                                particularly in resource-limited settings.
                            </p>
                        </div>
                    </div>

                    <div style="background: rgba(138, 180, 248, 0.1); padding: 1.5rem; border-radius: 0.75rem; border: 2px solid rgba(138, 180, 248, 0.3); margin-top: 2rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                            <i class="fas fa-bullhorn"></i>
                            Get in Touch
                        </h3>
                        <p style="color: var(--text); line-height: 1.7; margin-bottom: 1.5rem;">
Found a bug or have a suggestion? I'd love to hear from you! Feel free to reach out through any of the following channels:
                        </p>
                        
                                     <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
                            <a href="mailto:mudassiribrahim30@gmail.com" 
                               class="btn-primary" 
                               style="padding: 0.75rem 1.5rem; text-decoration: none; display: inline-flex; align-items: center; gap: 0.75rem;">
                                <i class="fas fa-envelope"></i>
                                Email
                            </a>
                            
                            <a href="https://github.com/mudassiribrahim30" 
                               target="_blank" 
                               rel="noopener noreferrer"
                               class="btn btn-github" 
                               style="text-decoration: none; display: inline-flex; align-items: center; gap: 0.75rem;">
                                <i class="fab fa-github"></i>
                                GitHub
                            </a>
                            
                            <a href="https://scholar.google.com/citations?user=xEFzAvgAAAAJ&hl=en" 
                               target="_blank" 
                               rel="noopener noreferrer"
                               class="btn btn-scholar" 
                               style="text-decoration: none; display: inline-flex; align-items: center; gap: 0.75rem;">
                                <i class="fas fa-graduation-cap"></i>
                                Google Scholar
                            </a>
                        </div>
                        </div>
                </div>
            </section>
        </main>

 <!-- Footer -->
<footer class="main-footer">
    <div class="footer-content">
        <div class="copyright">
            <p>Copyright © <span id="currentYear">2026</span> CATrend Analyzer – Open-Source Cochran–Armitage Trend Test (CATT) Web-Based Software. All rights reserved.</p>
            <p style="margin-top: 0.75rem; font-size: 0.875rem;">
                Version 1.0 | 
                Built with <span class="dangling-heart">❤️</span> from Ghana by 
                <a href="https://mudasiribrahim.com" target="_blank" rel="noopener noreferrer" style="color: var(--text); text-decoration: underline;">
                    Mudasir Mohammed Ibrahim
                </a> | 
                Last updated: <span id="lastUpdated">February 2026</span>
            </p>
        </div>
    </div>
</footer>

<script>
    // Automatically update the current year
    document.getElementById('currentYear').textContent = new Date().getFullYear();
    
    // Function to format month name
    function getMonthName(date) {
        const months = [
            'January', 'February', 'March', 'April', 'May', 'June',
            'July', 'August', 'September', 'October', 'November', 'December'
        ];
        return months[date.getMonth()];
    }
    
    // Automatically update the "Last updated" to current month and year
    function updateLastUpdated() {
        const now = new Date();
        const currentMonth = getMonthName(now);
        const currentYear = now.getFullYear();
        document.getElementById('lastUpdated').textContent = `${currentMonth} ${currentYear}`;
    }
    
    // Initialize on page load
    updateLastUpdated();
</script>
    </div>

    <script>
        // ============================================
        // GLOBAL VARIABLES
        // ============================================
        let currentData = null;
        let chartInstance = null;
        let analysisLoaded = false;
        let currentZoom = 90;
        
        // Default visualization data
        const defaultVisualizationData = {
            title: "Cochran-Armitage Trend Analysis",
            subtitle: "Increasing Success Rates Across Treatment Levels",
            labels: ["Level 1", "Level 2", "Level 3", "Level 4"],
            successRates: [40, 65, 80, 95],
            failureRates: [60, 35, 20, 5],
            totals: [100, 100, 100, 100],
            stats: {
                z: 4.32,
                p: "<0.001",
                trend: "Increasing"
            },
            tableData: {
                success: [40, 65, 80, 95],
                failure: [60, 35, 20, 5],
                total: [100, 100, 100, 100]
            }
        };
        
                // ============================================
        // SEO AND ENGAGEMENT OPTIMIZATION
        // ============================================
        
        // Track user engagement for SEO signals
        function trackEngagement() {
            let startTime = Date.now();
            let scrolled = false;
            let interacted = false;
            
            // Track scroll depth
            window.addEventListener('scroll', function() {
                if (!scrolled) {
                    scrolled = true;
                    // Send scroll signal (you can implement analytics here)
                }
                
                // Track 25%, 50%, 75%, 100% scroll depth
                const scrollPercent = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
                if (scrollPercent > 25 && !sessionStorage.getItem('scrolled25')) {
                    sessionStorage.setItem('scrolled25', 'true');
                    console.log('User scrolled 25% - good engagement signal');
                }
                if (scrollPercent > 50 && !sessionStorage.getItem('scrolled50')) {
                    sessionStorage.setItem('scrolled50', 'true');
                    console.log('User scrolled 50% - great engagement');
                }
                if (scrollPercent > 75 && !sessionStorage.getItem('scrolled75')) {
                    sessionStorage.setItem('scrolled75', 'true');
                    console.log('User scrolled 75% - excellent engagement');
                }
            });
            
            // Track time on page
            window.addEventListener('beforeunload', function() {
                let timeSpent = Math.round((Date.now() - startTime) / 1000);
                if (timeSpent > 30) {
                    console.log(`User spent ${timeSpent} seconds on page - good dwell time`);
                }
            });
            
            // Track clicks on key elements
            document.querySelectorAll('.btn-primary, .nav-link, .feature-item').forEach(el => {
                el.addEventListener('click', function() {
                    console.log('User clicked on important element - positive interaction');
                });
            });
        }

        // Call this after initialization
        setTimeout(trackEngagement, 1000);
        
        // ============================================
        // KEYWORD OPTIMIZATION FOR SEARCH
        // ============================================
        
        // This ensures search engines see the keywords in context
        function enhanceKeywordVisibility() {
            const keywords = [
                'Cochran-Armitage Trend Test',
                'CATT calculator',
                'trend analysis online',
                'statistical test calculator',
                'free statistics tool',
                'clinical trial statistics',
                'epidemiology calculator',
                'dose-response analysis',
                'trend test p-value',
                'contingency table analysis'
            ];
            
            // Keywords are already in the content, this just logs for verification
            console.log('SEO Keywords present:', keywords);
        }
        
        enhanceKeywordVisibility();
        
        // ============================================
        // HEADER SCROLL BEHAVIOR - ONLY SHOW AT TOP
        // ============================================
        function initializeHeaderScroll() {
            const header = document.querySelector('.app-header');
            const scrollThreshold = 50; // Pixels from top to consider "at top"
            
            // Add transition for smooth hide/show
            header.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
            
            function updateHeaderVisibility() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                if (scrollTop <= scrollThreshold) {
                    // At or near top - SHOW header
                    header.style.transform = 'translateY(0)';
                    header.style.opacity = '1';
                    header.style.pointerEvents = 'auto';
                } else {
                    // Scrolled down - HIDE header
                    header.style.transform = 'translateY(-100%)';
                    header.style.opacity = '0';
                    header.style.pointerEvents = 'none';
                }
            }
            
            // Initial check
            updateHeaderVisibility();
            
            // Update on scroll
            window.addEventListener('scroll', updateHeaderVisibility);
            
            // Also update on resize (for responsive adjustments)
            window.addEventListener('resize', updateHeaderVisibility);
            
            // Optional: Show header briefly when clicking on navigation
            document.querySelectorAll('.nav-link, .logo').forEach(element => {
                element.addEventListener('click', function() {
                    // Show header immediately when clicking navigation
                    header.style.transform = 'translateY(0)';
                    header.style.opacity = '1';
                    header.style.pointerEvents = 'auto';
                    
                    // Then hide it after 3 seconds if not at top
                    setTimeout(updateHeaderVisibility, 3000);
                });
            });
        }

        // ============================================
        // MAIN INITIALIZATION FUNCTION
        // ============================================
        function initializeApp() {
            console.log('Initializing CATrend Analyzer...');
            
            // Register Chart.js datalabels plugin
            Chart.register(ChartDataLabels);
            
            // Set current year
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Initialize theme toggle
            initializeThemeToggle();
            
            initializeDanglingHeart();
            
            // Initialize zoom functionality
            initializeZoom();
            
            // Initialize navigation event listeners
            initializeNavigation();
            
            // Initialize trend visualization with default data
            initializeTrendVisualization(defaultVisualizationData);
            
            // Initialize reset button
            initializeResetButton();
            
            // Initialize header scroll behavior (only shows at top)
            initializeHeaderScroll();
            
            // Initialize hamburger menu
            initializeHamburgerMenu();
            
            // Initialize analysisLoaded flag
            analysisLoaded = false;
            
            console.log('CATrend Analyzer initialized successfully');
        }
        
        function openFullscreenChart() {
    const modal = document.getElementById('fullscreenModal');
    const fullscreenCanvas = document.getElementById('fullscreenChart');
    const ctx = fullscreenCanvas.getContext('2d');
    
    // Show modal
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    
    // Copy chart data from original chart
    const originalChart = chartInstance;
    
    // Destroy existing fullscreen chart if it exists
    if (fullscreenChartInstance) {
        fullscreenChartInstance.destroy();
    }
    
    // Create fullscreen chart with enhanced options and white background
    fullscreenChartInstance = new Chart(ctx, {
        type: 'bar',
        data: JSON.parse(JSON.stringify(originalChart.data)), // Deep copy
        options: {
            responsive: true,
            maintainAspectRatio: false,
            backgroundColor: '#ffffff', // Ensure white background
            plugins: {
                title: {
                    display: true,
                    text: 'Frequency Distribution with Percentages - Full Screen View',
                    font: {
                        size: 24,
                        family: 'Inter',
                        weight: '700'
                    },
                    color: '#000000', // Black text for white background
                    padding: {
                        top: 20,
                        bottom: 30
                    }
                },
                legend: {
                    position: 'top',
                    labels: {
                        font: {
                            family: 'Inter',
                            size: 18,
                            weight: '600'
                        },
                        color: '#000000', // Black text for white background
                        padding: 20,
                        usePointStyle: true,
                        pointStyle: 'circle'
                    }
                },
                tooltip: {
                    backgroundColor: '#ffffff', // White background for tooltips
                    borderColor: '#dadce0', // Light gray border
                    borderWidth: 2,
                    padding: 16,
                    titleFont: {
                        size: 16,
                        family: 'Inter',
                        weight: '600'
                    },
                    bodyFont: {
                        size: 15,
                        family: 'Inter',
                        weight: '500'
                    },
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            label += context.parsed.y;
                            
                            if (showRowPercent) {
                                const rowIndex = context.datasetIndex;
                                const colIndex = context.dataIndex;
                                label += ` (${results.rowPercentages[rowIndex][colIndex]}% of row)`;
                            }
                            if (showColPercent) {
                                const rowIndex = context.datasetIndex;
                                const colIndex = context.dataIndex;
                                label += ` [${results.colPercentages[rowIndex][colIndex]}% of column]`;
                            }
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    color: function(context) {
                        const dataset = context.dataset;
                        const backgroundColor = dataset.backgroundColor;
                        if (backgroundColor === 'rgba(52, 168, 83, 0.7)' || backgroundColor === 'rgba(234, 67, 53, 0.7)') {
                            return '#ffffff';
                        }
                        return '#000000'; // Black text for light bars
                    },
                    font: {
                        weight: '600',
                        size: 14
                    },
                    formatter: function(value, context) {
                        const labels = context.chart.data.datasets[context.datasetIndex].dataLabels;
                        return labels ? labels[context.dataIndex] : value;
                    },
                    anchor: 'center',
                    align: 'center'
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Groups',
                        font: {
                            family: 'Inter',
                            size: 20,
                            weight: '700'
                        },
                        color: '#000000', // Black text for white background
                        padding: { top: 20 }
                    },
                    grid: {
                        color: '#e5e5e5', // Light gray grid lines
                        lineWidth: 2
                    },
                    ticks: {
                        color: '#000000', // Black text for white background
                        font: {
                            size: 16,
                            weight: '600'
                        },
                        padding: 10
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: 'Frequency',
                        font: {
                            family: 'Inter',
                            size: 20,
                            weight: '700'
                        },
                        color: '#000000', // Black text for white background
                        padding: { bottom: 20 }
                    },
                    beginAtZero: true,
                    ticks: {
                        precision: 0,
                        color: '#000000', // Black text for white background
                        font: {
                            size: 16,
                            weight: '600'
                        },
                        padding: 10
                    },
                    grid: {
                        color: '#e5e5e5', // Light gray grid lines
                        lineWidth: 2
                    }
                }
            },
            animation: {
                duration: 1000,
                easing: 'easeOutQuart'
            },
            interaction: {
                intersect: false,
                mode: 'index'
            }
        }
    });
    
    // Apply initial zoom
    applyChartZoom();
}

        // ============================================
        // HAMBURGER MENU FUNCTIONALITY
        // ============================================
        function initializeHamburgerMenu() {
            const hamburgerMenu = document.getElementById('hamburgerMenu');
            const mainNav = document.getElementById('mainNav');
            
            if (hamburgerMenu && mainNav) {
                hamburgerMenu.addEventListener('click', function() {
                    this.classList.toggle('active');
                    mainNav.classList.toggle('active');
                    
                    // Close menu when clicking outside
                    if (mainNav.classList.contains('active')) {
                        document.addEventListener('click', closeMenuOnClickOutside);
                    } else {
                        document.removeEventListener('click', closeMenuOnClickOutside);
                    }
                });
                
                // Close menu when clicking a nav link
                mainNav.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', function() {
                        hamburgerMenu.classList.remove('active');
                        mainNav.classList.remove('active');
                        document.removeEventListener('click', closeMenuOnClickOutside);
                    });
                });
            }
            
            function closeMenuOnClickOutside(event) {
                if (!mainNav.contains(event.target) && !hamburgerMenu.contains(event.target)) {
                    hamburgerMenu.classList.remove('active');
                    mainNav.classList.remove('active');
                    document.removeEventListener('click', closeMenuOnClickOutside);
                }
            }
        }

        // ============================================
        // TREND VISUALIZATION FUNCTIONS
        // ============================================
        function initializeTrendVisualization(data = null) {
            console.log('Initializing trend visualization...');
            
            const visualizationData = data || defaultVisualizationData;
            
            // Update titles
            document.getElementById('chartTitle').textContent = visualizationData.title;
            document.getElementById('chartSubtitle').textContent = visualizationData.subtitle;
            
            // Update labels
            updateTrendLabels(visualizationData.labels);
            
            // Update data points and trend line
            updateTrendLine(visualizationData.successRates);
            
            // Update statistics
            updateTrendStats(visualizationData.stats);
            
            // Update table
            updatePreviewTable(visualizationData.tableData, visualizationData.labels);
            
            // Add interactivity to data points
            initializeDataPointsInteractivity();
            
            console.log('Trend visualization initialized');
        }

        function updateTrendLabels(labels) {
            const trendLabelsContainer = document.getElementById('trendLabels');
            trendLabelsContainer.innerHTML = '';
            
            labels.forEach(label => {
                const labelElement = document.createElement('div');
                labelElement.className = 'trend-label';
                labelElement.textContent = label;
                labelElement.style.minWidth = `${Math.max(80, 100/labels.length)}px`;
                trendLabelsContainer.appendChild(labelElement);
            });
            
            // Adjust container for many columns
            if (labels.length > 6) {
                trendLabelsContainer.style.flexWrap = 'wrap';
                trendLabelsContainer.style.gap = '0.5rem';
            } else {
                trendLabelsContainer.style.flexWrap = 'nowrap';
                trendLabelsContainer.style.gap = '0';
            }
        }

        function updateTrendLine(successRates) {
            const trendLineContainer = document.getElementById('trendLineContainer');
            const trendLine = document.getElementById('trendLine');
            const trendLinePath = document.getElementById('trendLinePath');
            
            // Clear existing data points
            const existingPoints = trendLine.querySelectorAll('.data-point');
            existingPoints.forEach(point => point.remove());
            
            // Calculate positions for data points
            const numPoints = successRates.length;
            
            // Create new data points
            successRates.forEach((rate, index) => {
                const positionX = (index / (numPoints - 1)) * 100;
                const positionY = 100 - rate; // Convert rate to Y position (0% at top, 100% at bottom)
                
                const dataPoint = document.createElement('div');
                dataPoint.className = 'data-point';
                dataPoint.style.left = `${positionX}%`;
                dataPoint.style.top = `${positionY}%`;
                dataPoint.setAttribute('data-value', `${rate}%`);
                
                const tooltip = document.createElement('div');
                tooltip.className = 'point-tooltip';
                tooltip.textContent = `Success: ${rate}%`;
                dataPoint.appendChild(tooltip);
                
                trendLine.appendChild(dataPoint);
            });
            
            // Update trend line angle based on trend
            if (numPoints >= 2) {
                const firstRate = successRates[0];
                const lastRate = successRates[numPoints - 1];
                const angle = calculateTrendAngle(firstRate, lastRate);
                
                trendLinePath.style.transform = `rotate(${angle}deg)`;
                trendLinePath.style.width = '100%';
                trendLinePath.style.top = '0';
            }
            
            // Adjust container width for many points
            if (numPoints > 8) {
                trendLineContainer.style.minWidth = `${numPoints * 60}px`;
            } else {
                trendLineContainer.style.minWidth = '400px';
            }
        }

        function calculateTrendAngle(firstRate, lastRate) {
            // Calculate angle based on rate difference
            // 0% difference = 0 degrees (horizontal)
            // 100% difference = -30 degrees (steep downward)
            const rateDiff = lastRate - firstRate;
            const maxDiff = 100; // Maximum possible difference
            const angle = -15 * (rateDiff / maxDiff) * 100; // Scale to -30 to 30 degrees
            
            return Math.max(-30, Math.min(30, angle)); // Clamp between -30 and 30 degrees
        }

        function updateTrendStats(stats) {
            document.getElementById('zStatValue').textContent = stats.z;
            document.getElementById('pValue').textContent = stats.p;
            
            const trendElement = document.getElementById('trendValue');
            trendElement.textContent = stats.trend;
            
            // Update color based on trend direction
            if (stats.trend.toLowerCase().includes('increas')) {
                trendElement.className = 'stat-value trend-up';
            } else if (stats.trend.toLowerCase().includes('decreas')) {
                trendElement.className = 'stat-value trend-down';
            } else {
                trendElement.className = 'stat-value';
            }
        }

        function updatePreviewTable(tableData, labels) {
            const previewTable = document.getElementById('previewTable');
            
            // Clear existing table
            previewTable.innerHTML = '';
            
            // Create header
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th></th>';
            
            labels.forEach(label => {
                const th = document.createElement('th');
                th.textContent = label;
                th.style.minWidth = `${Math.max(80, 100/labels.length)}px`;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            previewTable.appendChild(thead);
            
            // Create body
            const tbody = document.createElement('tbody');
            
            // Success row
            const successRow = document.createElement('tr');
            successRow.innerHTML = '<td class="row-header">Success</td>';
            tableData.success.forEach(value => {
                const td = document.createElement('td');
                td.textContent = value;
                successRow.appendChild(td);
            });
            tbody.appendChild(successRow);
            
            // Failure row
            const failureRow = document.createElement('tr');
            failureRow.innerHTML = '<td class="row-header">Failure</td>';
            tableData.failure.forEach(value => {
                const td = document.createElement('td');
                td.textContent = value;
                failureRow.appendChild(td);
            });
            tbody.appendChild(failureRow);
            
            // Total row
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            totalRow.innerHTML = '<td class="row-header">Total</td>';
            tableData.total.forEach(value => {
                const td = document.createElement('td');
                td.textContent = value;
                totalRow.appendChild(td);
            });
            tbody.appendChild(totalRow);
            
            previewTable.appendChild(tbody);
            
            // Adjust table for many columns
            if (labels.length > 6) {
                previewTable.style.fontSize = '0.8rem';
            } else {
                previewTable.style.fontSize = '0.9rem';
            }
        }

        function initializeDataPointsInteractivity() {
            const dataPoints = document.querySelectorAll('.data-point');
            dataPoints.forEach(point => {
                point.addEventListener('click', function() {
                    const value = this.getAttribute('data-value');
                    const tooltip = this.querySelector('.point-tooltip');
                    
                    // Animate the point
                    this.style.transform = 'translate(-50%, -50%) scale(1.5)';
                    this.style.backgroundColor = 'var(--primary)';
                    
                    // Show tooltip
                    tooltip.style.opacity = '1';
                    tooltip.style.transform = 'translate(-50%, -15px)';
                    
                    // Reset after animation
                    setTimeout(() => {
                        this.style.transform = 'translate(-50%, -50%) scale(1)';
                        this.style.backgroundColor = 'var(--success)';
                        tooltip.style.opacity = '0';
                        tooltip.style.transform = 'translate(-50%, -10px)';
                    }, 1000);
                });
                
                // Hover effects
                point.addEventListener('mouseenter', function() {
                    this.style.zIndex = '10';
                });
                
                point.addEventListener('mouseleave', function() {
                    this.style.zIndex = '2';
                });
            });
            
            // Add animation to trend line
            const trendLine = document.querySelector('.trend-line-path');
            if (trendLine) {
                // Animate the trend line on load
                setTimeout(() => {
                    trendLine.style.transition = 'all 1.5s ease';
                    trendLine.style.opacity = '1';
                }, 500);
            }
            
            // Add animation to stat cards
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    card.style.transition = 'all 0.5s ease';
                    
                    // Trigger reflow
                    card.offsetHeight;
                    
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 800 + (index * 200));
            });
        }

        function initializeResetButton() {
            const resetBtn = document.getElementById('resetVisualizationBtn');
            if (resetBtn) {
                resetBtn.addEventListener('click', function() {
                    // Reset to default visualization
                    initializeTrendVisualization(defaultVisualizationData);
                    
                    // Show confirmation message
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Reset Complete!';
                    this.style.backgroundColor = 'var(--success)';
                    
                    // Reset button after 2 seconds
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.backgroundColor = '';
                    }, 2000);
                    
                    // Scroll visualization into view
                    document.getElementById('heroVisual').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                });
            }
        }

        // ============================================
        // SECTION NAVIGATION FUNCTIONS
        // ============================================
        function showSection(sectionId) {
            console.log('Showing section:', sectionId);
            
            // Update active nav link
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(nav => nav.classList.remove('active'));
            
            // Activate the clicked nav link
            const activeNavLink = document.querySelector(`.nav-link[href="#${sectionId}"]`);
            if (activeNavLink) {
                activeNavLink.classList.add('active');
            }
            
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Show selected tab content
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.add('active');
                
                // If analysis tab is clicked, load the analysis content
                if (sectionId === 'analysis' && !analysisLoaded) {
                    loadAnalysisContent();
                    analysisLoaded = true;
                }
                
                // Close hamburger menu if open
                const hamburgerMenu = document.getElementById('hamburgerMenu');
                const mainNav = document.getElementById('mainNav');
                if (hamburgerMenu && mainNav && hamburgerMenu.classList.contains('active')) {
                    hamburgerMenu.classList.remove('active');
                    mainNav.classList.remove('active');
                }
                
                // Scroll to top of section
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function initializeNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('href').substring(1);
                    showSection(sectionId);
                });
            });
            
            // Logo click event
            const logo = document.querySelector('.logo');
            if (logo) {
                logo.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSection('home');
                });
            }
        }
        
        // Add this to your JavaScript after the main initialization
function initializeDanglingHeart() {
    const heart = document.querySelector('.dangling-heart');
    if (heart) {
        heart.addEventListener('click', function() {
            // Add a click animation
            this.style.transform = 'scale(1.5)';
            this.style.color = '#ff4444';
            
            // Create floating hearts effect
            for (let i = 0; i < 5; i++) {
                createFloatingHeart(this);
            }
            
            // Reset after animation
            setTimeout(() => {
                this.style.transform = '';
                this.style.color = '';
            }, 300);
        });
    }
    
    function createFloatingHeart(heartElement) {
        const heart = document.createElement('div');
        heart.innerHTML = '❤️';
        heart.style.position = 'fixed';
        heart.style.left = heartElement.getBoundingClientRect().left + 'px';
        heart.style.top = heartElement.getBoundingClientRect().top + 'px';
        heart.style.fontSize = '20px';
        heart.style.opacity = '1';
        heart.style.zIndex = '10000';
        heart.style.pointerEvents = 'none';
        heart.style.transition = 'all 1s ease-out';
        
        document.body.appendChild(heart);
        
        // Animate floating up
        setTimeout(() => {
            const randomX = Math.random() * 100 - 50;
            const randomY = -100 - Math.random() * 50;
            heart.style.transform = `translate(${randomX}px, ${randomY}px)`;
            heart.style.opacity = '0';
        }, 10);
        
        // Remove after animation
        setTimeout(() => {
            document.body.removeChild(heart);
        }, 1100);
    }
}

        // ============================================
        // ANALYSIS FUNCTIONS
        // ============================================
        function loadAnalysisContent() {
            console.log('Loading analysis content...');
            const analysisTab = document.getElementById('analysis');
            
            // Create the analysis content
            analysisTab.innerHTML = `
                <div class="hero-section">
                    <h1 class="hero-title">Cochran-Armitage Trend Test Analysis</h1>
                    <p class="hero-subtitle">
                        Perform statistical trend analysis on your contingency table data. 
                        Enter frequencies, configure test options, and run the analysis.
                    </p>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-table"></i>
                        Contingency Table Input
                    </h2>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Instructions:</strong> Enter your contingency table data below. 
                            Rows represent different outcomes (e.g., Success/Failure). 
                            Columns represent ordered groups (e.g., Treatment levels 1, 2, 3).
                            Enter frequency counts in the cells.
                        </div>
                    </div>
                    
                    <!-- Table Controls -->
                    <div class="table-controls">
                        <div class="control-group">
                            <div class="group-title">Row Management</div>
                            <div class="button-group">
                                <button class="btn btn-success" id="addRowBtn">
                                    <i class="fas fa-plus"></i>
                                    Add Row
                                </button>
                                <button class="btn btn-danger" id="removeRowBtn">
                                    <i class="fas fa-minus"></i>
                                    Remove Row
                                </button>
                            </div>
                            <div class="header-inputs">
                                <div class="header-group">
                                    <div class="header-group-title">
                                        <i class="fas fa-list"></i>
                                        Row Headers (Outcomes):
                                    </div>
                                    <div id="rowHeadersContainer">
                                        <!-- Row headers will be added here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <div class="group-title">Column Management</div>
                            <div class="button-group">
                                <button class="btn btn-success" id="addColBtn">
                                    <i class="fas fa-plus"></i>
                                    Add Column
                                </button>
                                <button class="btn btn-danger" id="removeColBtn">
                                    <i class="fas fa-minus"></i>
                                    Remove Column
                                </button>
                            </div>
                            <div class="header-inputs">
                                <div class="header-group">
                                    <div class="header-group-title">
                                        <i class="fas fa-columns"></i>
                                        Column Headers (Ordered Groups):
                                    </div>
                                    <div id="colHeadersContainer">
                                        <!-- Column headers will be added here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contingency Table -->
                    <div class="table-container">
                        <table class="data-table" id="contingencyTable">
                            <thead id="tableHeader">
                                <!-- Table header will be populated -->
                            </thead>
                            <tbody id="tableBody">
                                <!-- Table body will be populated -->
                            </tbody>
                        </table>
                    </div>
                    
            <!-- Analysis Configuration -->
<div class="analysis-controls">
    <div class="analysis-group">
        <h3 class="card-title" style="margin-bottom: 1.5rem;">
            <i class="fas fa-cog"></i>
            Test Configuration
        </h3>
        
        <div class="test-configuration">
            <div class="test-config-title">
                <i class="fas fa-sliders-h"></i>
                Test Type (Default: One-sided Decreasing)
            </div>
            <div class="test-config-options">
                <label class="test-config-option">
                    <input type="radio" name="testType" value="one.sided.decreasing" checked>
                    <span>One-sided (decreasing trend) <span class="config-help">- Default</span></span>
                </label>
                <label class="test-config-option">
                    <input type="radio" name="testType" value="one.sided.increasing">
                    <span>One-sided (increasing trend)</span>
                </label>
                <label class="test-config-option">
                    <input type="radio" name="testType" value="two.sided">
                    <span>Two-sided test</span>
                </label>
            </div>
        </div>
        
        <div style="margin-top: 1.75rem;">
            <label class="checkbox-option">
                <input type="checkbox" id="continuityCorrection">
                <span>Apply continuity correction (recommended for N < 100)</span>
            </label>
        </div>
    </div>
    
    <div class="analysis-group">
        <h3 class="card-title" style="margin-bottom: 1.5rem;">
            <i class="fas fa-chart-bar"></i>
            Chart Options
        </h3>
        
        <div class="checkbox-group">
            <label class="checkbox-option">
                <input type="checkbox" id="showCounts" checked>
                <span>Show counts on bars</span>
            </label>
            <label class="checkbox-option">
                <input type="checkbox" id="showRowPercent">
                <span>Show row percentages</span>
            </label>
            <label class="checkbox-option">
                <input type="checkbox" id="showColPercent" checked>
                <span>Show column percentages</span>
            </label>
        </div>
        
        <div class="formula-box" style="font-size: 1.125rem; padding: 1.25rem; margin-top: 1.5rem;">
            Z = Σ yⱼ(xⱼ - x̄) / √[p̄(1-p̄) Σ nⱼ(xⱼ - x̄)²]
        </div>
    </div>
</div>

                <!-- Run Analysis Button -->
                <div class="run-analysis">
                    <button class="run-btn" id="runAnalysisBtn">
                        <i class="fas fa-play"></i>
                        Run Cochran-Armitage Test
                    </button>
                    <div class="alert alert-warning" id="dataWarning" style="display: none; margin-top: 1.25rem;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>Please enter valid numeric data in all table cells before running analysis.</div>
                    </div>
                </div>

                <!-- Results Section (Initially hidden) -->
                <div class="results-section" id="resultsSection">
                    <!-- Results will be populated here -->
                </div>
            `;
            
            // Now initialize the analysis functionality
            initializeAnalysis();
        }

        function initializeAnalysis() {
            console.log('Initializing analysis functionality...');
            
            // Initial table data
            const initialData = {
                rows: ['Success', 'Failure'],
                cols: ['Level 1', 'Level 2', 'Level 3'],
                data: [
                    [10, 25, 30],
                    [30, 15, 10]
                ]
            };

            currentData = JSON.parse(JSON.stringify(initialData));
            chartInstance = null;

            // Update table display
            function updateTable() {
                const tableHeader = document.getElementById('tableHeader');
                const tableBody = document.getElementById('tableBody');
                const rowHeadersContainer = document.getElementById('rowHeadersContainer');
                const colHeadersContainer = document.getElementById('colHeadersContainer');
                
                // Clear existing content
                tableHeader.innerHTML = '';
                tableBody.innerHTML = '';
                rowHeadersContainer.innerHTML = '';
                colHeadersContainer.innerHTML = '';
                
                // Create header row
                const headerRow = document.createElement('tr');
                
                // Empty corner cell
                const emptyHeader = document.createElement('th');
                emptyHeader.textContent = '';
                headerRow.appendChild(emptyHeader);
                
                // Column headers
                currentData.cols.forEach((col, colIndex) => {
                    const th = document.createElement('th');
                    th.textContent = col;
                    headerRow.appendChild(th);
                });
                
                // Total column header
                const totalHeader = document.createElement('th');
                totalHeader.textContent = 'Total';
                totalHeader.className = 'total-cell';
                headerRow.appendChild(totalHeader);
                
                // Column percentage header
                const colPercentHeader = document.createElement('th');
                colPercentHeader.textContent = 'Col %';
                colPercentHeader.className = 'total-cell';
                colPercentHeader.style.fontSize = '0.9em';
                headerRow.appendChild(colPercentHeader);
                
                tableHeader.appendChild(headerRow);
                
                // Calculate totals for expected counts
                const rowTotals = currentData.data.map(row => row.reduce((a, b) => a + b, 0));
                const colTotals = currentData.cols.map((_, colIndex) => 
                    currentData.data.reduce((sum, row) => sum + row[colIndex], 0)
                );
                const grandTotal = rowTotals.reduce((a, b) => a + b, 0);
                
                // Create data rows
                currentData.rows.forEach((row, rowIndex) => {
                    const tr = document.createElement('tr');
                    
                    // Row header cell
                    const rowHeader = document.createElement('td');
                    rowHeader.className = 'total-cell';
                    rowHeader.textContent = row;
                    tr.appendChild(rowHeader);
                    
                    // Data cells
                    currentData.data[rowIndex].forEach((cell, colIndex) => {
                        const td = document.createElement('td');
                        const input = document.createElement('input');
                        input.type = 'number';
                        input.min = '0';
                        input.value = cell;
                        input.addEventListener('input', (e) => {
                            const value = parseInt(e.target.value) || 0;
                            currentData.data[rowIndex][colIndex] = value;
                            updateRowTotal(tr, rowIndex);
                            updateColTotals();
                        });
                        td.appendChild(input);
                        tr.appendChild(td);
                    });
                    
                    // Row total cell
                    const rowTotalCell = document.createElement('td');
                    rowTotalCell.className = 'total-cell';
                    rowTotalCell.textContent = rowTotals[rowIndex];
                    rowTotalCell.id = `rowTotal-${rowIndex}`;
                    tr.appendChild(rowTotalCell);
                    
                    // Row percentage cell
                    const rowPercentCell = document.createElement('td');
                    rowPercentCell.className = 'total-cell';
                    rowPercentCell.style.fontSize = '0.9em';
                    const rowPercent = grandTotal > 0 ? ((rowTotals[rowIndex] / grandTotal) * 100).toFixed(1) : '0.0';
                    rowPercentCell.textContent = `${rowPercent}%`;
                    rowPercentCell.id = `rowPercent-${rowIndex}`;
                    tr.appendChild(rowPercentCell);
                    
                    tableBody.appendChild(tr);
                });
                
                // Add column totals row
                const totalsRow = document.createElement('tr');
                const totalsLabel = document.createElement('td');
                totalsLabel.textContent = 'Total';
                totalsLabel.className = 'total-cell';
                totalsRow.appendChild(totalsLabel);
                
                currentData.cols.forEach((_, colIndex) => {
                    const td = document.createElement('td');
                    td.className = 'total-cell';
                    td.textContent = colTotals[colIndex];
                    td.id = `colTotal-${colIndex}`;
                    totalsRow.appendChild(td);
                });
                
                const grandTotalCell = document.createElement('td');
                grandTotalCell.className = 'total-cell';
                grandTotalCell.textContent = grandTotal;
                grandTotalCell.id = 'grandTotal';
                totalsRow.appendChild(grandTotalCell);
                
                // Column percentage cell
                const colPercentCell = document.createElement('td');
                colPercentCell.className = 'total-cell';
                colPercentCell.textContent = '100.0%';
                colPercentCell.style.fontSize = '0.9em';
                totalsRow.appendChild(colPercentCell);
                
                tableBody.appendChild(totalsRow);
                
                // Add expected counts row if enabled
                const showExpected = document.getElementById('showExpectedCounts')?.checked;
                if (showExpected) {
                    const expectedRow = document.createElement('tr');
                    expectedRow.className = 'expected-row';
                    
                    const expectedLabel = document.createElement('td');
                    expectedLabel.textContent = 'Expected';
                    expectedLabel.className = 'total-cell';
                    expectedLabel.style.fontStyle = 'italic';
                    expectedRow.appendChild(expectedLabel);
                    
                    currentData.cols.forEach((_, colIndex) => {
                        currentData.rows.forEach((_, rowIndex) => {
                            const expected = (rowTotals[rowIndex] * colTotals[colIndex]) / grandTotal;
                            const td = document.createElement('td');
                            td.textContent = expected.toFixed(1);
                            td.style.fontStyle = 'italic';
                            td.style.color = 'var(--secondary)';
                            expectedRow.appendChild(td);
                        });
                    });
                    
                    // Fill remaining cells
                    for (let i = 0; i < 2; i++) {
                        const td = document.createElement('td');
                        td.textContent = '-';
                        expectedRow.appendChild(td);
                    }
                    
                    tableBody.appendChild(expectedRow);
                }
                
                // Update header inputs
                currentData.rows.forEach((row, index) => {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.value = row;
                    input.className = 'header-input';
                    input.placeholder = `Row ${index + 1}`;
                    input.addEventListener('change', (e) => {
                        currentData.rows[index] = e.target.value;
                        updateTable();
                    });
                    rowHeadersContainer.appendChild(input);
                });
                
                currentData.cols.forEach((col, index) => {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.value = col;
                    input.className = 'header-input';
                    input.placeholder = `Column ${index + 1}`;
                    input.addEventListener('change', (e) => {
                        currentData.cols[index] = e.target.value;
                        updateTable();
                    });
                    colHeadersContainer.appendChild(input);
                });
                
                // Update percentages
                updatePercentages();
            }

            // Update row total
            function updateRowTotal(rowElement, rowIndex) {
                const rowData = currentData.data[rowIndex];
                const rowTotal = rowData.reduce((sum, cell) => sum + cell, 0);
                const rowTotalCell = document.getElementById(`rowTotal-${rowIndex}`);
                if (rowTotalCell) {
                    rowTotalCell.textContent = rowTotal;
                }
                updateGrandTotal();
                updatePercentages();
            }

            // Update column totals
            function updateColTotals() {
                const colTotals = currentData.cols.map((_, colIndex) => 
                    currentData.data.reduce((sum, row) => sum + row[colIndex], 0)
                );
                
                currentData.cols.forEach((_, colIndex) => {
                    const colTotalCell = document.getElementById(`colTotal-${colIndex}`);
                    if (colTotalCell) {
                        colTotalCell.textContent = colTotals[colIndex];
                    }
                });
                
                updateGrandTotal();
                updatePercentages();
            }

            // Update grand total
            function updateGrandTotal() {
                const grandTotal = currentData.data.flat().reduce((sum, cell) => sum + cell, 0);
                const grandTotalCell = document.getElementById('grandTotal');
                if (grandTotalCell) {
                    grandTotalCell.textContent = grandTotal;
                }
            }

            // Update percentages
            function updatePercentages() {
                const rowTotals = currentData.data.map(row => row.reduce((a, b) => a + b, 0));
                const grandTotal = rowTotals.reduce((a, b) => a + b, 0);
                
                // Update row percentages
                currentData.rows.forEach((_, rowIndex) => {
                    const rowPercentCell = document.getElementById(`rowPercent-${rowIndex}`);
                    if (rowPercentCell && grandTotal > 0) {
                        const rowPercent = (rowTotals[rowIndex] / grandTotal) * 100;
                        rowPercentCell.textContent = `${rowPercent.toFixed(1)}%`;
                    }
                });
            }

            // Add a new row
            function addRow() {
                const newRowName = `Outcome ${currentData.rows.length + 1}`;
                currentData.rows.push(newRowName);
                const newRow = new Array(currentData.cols.length).fill(0);
                currentData.data.push(newRow);
                updateTable();
            }

            // Remove last row
            function removeRow() {
                if (currentData.rows.length > 1) {
                    currentData.rows.pop();
                    currentData.data.pop();
                    updateTable();
                }
            }

            // Add a new column
            function addColumn() {
                const newColName = `Level ${currentData.cols.length + 1}`;
                currentData.cols.push(newColName);
                currentData.data.forEach(row => row.push(0));
                updateTable();
            }

            // Remove last column
            function removeColumn() {
                if (currentData.cols.length > 1) {
                    currentData.cols.pop();
                    currentData.data.forEach(row => row.pop());
                    updateTable();
                }
            }

            // Error function approximation
            function erf(x) {
                const a1 =  0.254829592;
                const a2 = -0.284496736;
                const a3 =  1.421413741;
                const a4 = -1.453152027;
                const a5 =  1.061405429;
                const p  =  0.3275911;
                
                const sign = (x >= 0) ? 1 : -1;
                x = Math.abs(x);
                
                const t = 1.0 / (1.0 + p * x);
                const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
                
                return sign * y;
            }

      function calculateChiSquareAssociation(data) {
    const { rows, cols, data: tableData } = data;
    const r = rows.length;
    const c = cols.length;
    
    // Calculate row and column totals
    const rowTotals = tableData.map(row => row.reduce((a, b) => a + b, 0));
    const colTotals = cols.map((_, j) => tableData.reduce((sum, row) => sum + row[j], 0));
    const grandTotal = rowTotals.reduce((a, b) => a + b, 0);
    
    // Calculate chi-square statistic
    let chiSquare = 0;
    for (let i = 0; i < r; i++) {
        for (let j = 0; j < c; j++) {
            const observed = tableData[i][j];
            const expected = (rowTotals[i] * colTotals[j]) / grandTotal;
            if (expected > 0) {
                chiSquare += Math.pow(observed - expected, 2) / expected;
            }
        }
    }
    
    // Calculate degrees of freedom
    const df = (r - 1) * (c - 1);
    
    // SAS EXACT p-value calculation using incomplete gamma function
    const pValue = sasChiSquarePValue(chiSquare, df);
    
    return {
        statistic: chiSquare,
        df: df,
        pValue: pValue
    };
}

// SAS EXACT p-value calculation (matches PROC FREQ output)
function sasChiSquarePValue(chiSquare, df) {
    if (chiSquare <= 0 || df <= 0) return 1.0;
    
    // SAS uses: p = 1 - P(χ² ≤ x | df)
    // Where P(χ² ≤ x | df) = γ(df/2, x/2) / Γ(df/2)
    // γ = lower incomplete gamma function
    // Γ = complete gamma function
    
    return 1 - incompleteGamma(df / 2, chiSquare / 2);
}

// Lower incomplete gamma function - SAS algorithm
function incompleteGamma(a, x) {
    if (x <= 0) return 0;
    if (a <= 0) return 1;
    
    // For small x, use series expansion (SAS method)
    if (x < a + 1) {
        return incompleteGammaSeries(a, x);
    }
    
    // For large x, use continued fraction (SAS method)
    return 1 - incompleteGammaContinuedFraction(a, x);
}

// Series expansion for lower incomplete gamma (small x)
function incompleteGammaSeries(a, x) {
    let sum = 0;
    let term = 1 / a;
    let n = 1;
    
    while (true) {
        sum += term;
        term *= x / (a + n);
        n++;
        
        // SAS precision level
        if (Math.abs(term) < 1e-15 || n > 1000) break;
    }
    
    return Math.exp(-x) * Math.pow(x, a) * sum;
}

// Continued fraction for upper incomplete gamma (large x) - SAS uses Lentz algorithm
function incompleteGammaContinuedFraction(a, x) {
    const FPMIN = 1e-30;
    const EPS = 1e-15;
    const MAX_ITER = 1000;
    
    let b = x + 1 - a;
    let c = 1 / FPMIN;
    let d = 1 / b;
    let h = d;
    
    for (let i = 1; i <= MAX_ITER; i++) {
        const an = -i * (i - a);
        b += 2;
        d = an * d + b;
        if (Math.abs(d) < FPMIN) d = FPMIN;
        c = b + an / c;
        if (Math.abs(c) < FPMIN) c = FPMIN;
        d = 1 / d;
        const del = d * c;
        h *= del;
        
        if (Math.abs(del - 1) < EPS) break;
    }
    
    return Math.exp(-x) * Math.pow(x, a) * h;
}

// Complete gamma function (SAS uses Lanczos approximation)
function completeGamma(z) {
    // Lanczos approximation (SAS uses similar)
    const g = 7;
    const p = [
        0.99999999999980993,
        676.5203681218851,
        -1259.1392167224028,
        771.32342877765313,
        -176.61502916214059,
        12.507343278686905,
        -0.13857109526572012,
        9.9843695780195716e-6,
        1.5056327351493116e-7
    ];
    
    if (z < 0.5) {
        return Math.PI / (Math.sin(Math.PI * z) * completeGamma(1 - z));
    }
    
    z -= 1;
    let x = p[0];
    for (let i = 1; i < g + 2; i++) {
        x += p[i] / (z + i);
    }
    const t = z + g + 0.5;
    
    return Math.sqrt(2 * Math.PI) * Math.pow(t, z + 0.5) * Math.exp(-t) * x;
}

            // Perform Cochran-Armitage test
            function performCochranArmitageTest() {
                const testType = document.querySelector('input[name="testType"]:checked').value;
                const continuityCorrection = document.getElementById('continuityCorrection').checked;
                
                const { rows, cols, data } = currentData;
                
                // Calculate totals
                const N = data.flat().reduce((a, b) => a + b, 0);
                const k = cols.length;
                
                // Assign scores (1, 2, 3, ...)
                const x = Array.from({length: k}, (_, i) => i + 1);
                
                // Calculate column totals (nj) and success counts (yj)
                const nj = Array(k).fill(0);
                const yj = Array(k).fill(0);
                
                for (let j = 0; j < k; j++) {
                    for (let i = 0; i < rows.length; i++) {
                        nj[j] += data[i][j];
                        if (i === 0) { // First row is "success"
                            yj[j] += data[i][j];
                        }
                    }
                }
                
                // Calculate observed response probabilities
                const pj = yj.map((y, idx) => nj[idx] > 0 ? y / nj[idx] : 0);
                
                // Calculate weighted mean of scores
                const x_bar = nj.reduce((sum, n, idx) => sum + n * x[idx], 0) / N;
                
                // Calculate numerator: Σyj(xj - x̄)
                const numerator = yj.reduce((sum, y, idx) => sum + y * (x[idx] - x_bar), 0);
                
                // Calculate overall proportion
                const p_bar = yj.reduce((a, b) => a + b, 0) / N;
                
                // Calculate variance term
                const variance_term = p_bar * (1 - p_bar) * nj.reduce((sum, n, idx) => sum + n * Math.pow(x[idx] - x_bar, 2), 0);
                
                // Apply continuity correction
                let c = 0;
                if (continuityCorrection) {
                    c = 0.5;
                }
                
// In the performCochranArmitageTest() function:
// Calculate z-statistic with proper sign handling
let z;
if (testType === 'one.sided.decreasing') {
    // For one-sided decreasing test: we want negative z for decreasing trends
    if (numerator < 0) {
        // Decreasing trend: numerator is negative, get negative z
        z = (-Math.abs(numerator) - c) / Math.sqrt(variance_term);
    } else {
        // Increasing trend when we expect decreasing: positive z
        z = (Math.abs(numerator) - c) / Math.sqrt(variance_term);
    }
} else if (testType === 'one.sided.increasing') {
    // For one-sided increasing test: we want positive z for increasing trends
    z = (Math.abs(numerator) - c) / Math.sqrt(variance_term);
} else {
    // Two-sided test: absolute value
    z = (Math.abs(numerator) - c) / Math.sqrt(variance_term);
}
// Calculate p-value
let p_value;
const normalCDF = (z) => {
    return (1 + erf(z / Math.sqrt(2))) / 2;
};

if (testType === 'two.sided') {
    p_value = 2 * (1 - normalCDF(Math.abs(z)));
} else if (testType === 'one.sided.increasing') {
    p_value = 1 - normalCDF(z);
} else if (testType === 'one.sided.decreasing') {
    p_value = normalCDF(z);
}
                
                // Calculate chi-square
                const chi_square = z * z;
                
                // Calculate chi-square for association
                const chiSquareAssociation = calculateChiSquareAssociation(currentData);
                
                // Calculate percentages for chart
                const rowTotals = data.map(row => row.reduce((a, b) => a + b, 0));
                const colTotals = nj;
                const rowPercentages = data.map((row, i) => 
                    row.map(cell => rowTotals[i] > 0 ? (cell / rowTotals[i] * 100).toFixed(1) : '0.0')
                );
                const colPercentages = data.map((row, i) => 
                    row.map((cell, j) => colTotals[j] > 0 ? (cell / colTotals[j] * 100).toFixed(1) : '0.0')
                );
                
                return {
                    z: z,
                    chi_square: chi_square,
                    chi_square_association: chiSquareAssociation,
                    p_value: p_value,
                    N: N,
                    k: k,
                    x_bar: x_bar,
                    p_bar: p_bar,
                    numerator: numerator,
                    variance_term: variance_term,
                    testType: testType,
                    continuityCorrection: continuityCorrection,
                    correctionFactor: c,
                    nj: nj,
                    yj: yj,
                    pj: pj,
                    rowTotals: rowTotals,
                    colTotals: colTotals,
                    rowPercentages: rowPercentages,
                    colPercentages: colPercentages,
                    successRates: pj.map(p => Math.round(p * 100)),
                    labels: cols,
                    degreesOfFreedom: (rows.length - 1) * (cols.length - 1)
                };
            }

            // Update results display
            function updateResults(results) {
                const resultsSection = document.getElementById('resultsSection');
                const showCounts = document.getElementById('showCounts').checked;
                const showRowPercent = document.getElementById('showRowPercent').checked;
                const showColPercent = document.getElementById('showColPercent').checked;
                
                // Generate interpretation
                let interpretation = '';
                if (results.p_value < 0.001) {
                    interpretation = `There is a highly significant trend in proportions across the ordered groups (p < 0.001). `;
                } else if (results.p_value < 0.01) {
                    interpretation = `There is a very significant trend in proportions across the ordered groups (p < 0.01). `;
                } else if (results.p_value < 0.05) {
                    interpretation = `There is a statistically significant trend in proportions across the ordered groups (p < 0.05). `;
                } else {
                    interpretation = `No statistically significant trend was detected across the ordered groups (p = ${results.p_value.toFixed(4)}). `;
                }
                
                if (results.testType === 'one.sided.increasing' && results.p_value < 0.05) {
                    interpretation += `The evidence supports an increasing trend across groups.`;
                } else if (results.testType === 'one.sided.decreasing' && results.p_value < 0.05) {
                    interpretation += `The evidence supports a decreasing trend across groups.`;
                } else if (results.p_value < 0.05) {
                    interpretation += `There is a systematic relationship between the outcome and the ordered groups.`;
                } else {
                    interpretation += `This suggests no systematic relationship between the outcome and the ordered groups.`;
                }
                
                // Generate practical implications
                let implications = '';
                if (results.p_value < 0.05) {
                    implications = `Based on these results, there is statistical evidence to support a trend across the groups. In practical terms, this suggests that the outcome variable shows a systematic change across the ordered categories. The direction of the trend (increasing or decreasing) depends on your research question and the nature of the variables.`;
                } else {
                    implications = `These results do not provide statistical evidence for a trend across the groups. In practical terms, this suggests that the outcome variable does not show a systematic change across the ordered categories. Consider whether sample size may be a factor, or whether different groupings might reveal different patterns.`;
                }
                
                // Test type display
                const testTypeText = {
                    'two.sided': 'Two-sided',
                    'one.sided.increasing': 'One-sided (increasing)',
                    'one.sided.decreasing': 'One-sided (decreasing)'
                }[results.testType];
                
                // Determine trend direction
                let trendDirection = "No trend";
                if (results.p_value < 0.05) {
                    if (results.testType === 'one.sided.increasing') {
                        trendDirection = "Increasing";
                    } else if (results.testType === 'one.sided.decreasing') {
                        trendDirection = "Decreasing";
                    } else {
                        // For two-sided test, determine based on numerator
                        trendDirection = results.numerator > 0 ? "Increasing" : "Decreasing";
                    }
                }
                
                // Format p-value for display
                let pValueDisplay = results.p_value.toFixed(6);
                if (results.p_value < 0.001) {
                    pValueDisplay = "<0.001";
                } else if (results.p_value < 0.01) {
                    pValueDisplay = results.p_value.toFixed(4);
                }
                
                // Update home page visualization with analysis results
                updateHomeVisualizationWithResults(results);
                
                // Create results HTML
                resultsSection.innerHTML = `
                    <div class="card">
                        <h2 class="card-title">
                            <i class="fas fa-chart-line"></i>
                            Analysis Results
                        </h2>
                        
                       <div class="enhanced-results">
    <div class="enhanced-stat-card">
        <div class="enhanced-stat-card-title">
            <i class="fas fa-calculator"></i>
            Z-statistic
        </div>
        <div class="enhanced-stat-value highlight">${results.z.toFixed(4)}</div>
        <div class="enhanced-stat-description">
            Standard normal deviate for trend test
        </div>
    </div>
    
    <div class="enhanced-stat-card">
        <div class="enhanced-stat-card-title">
            <i class="fas fa-sigma"></i>
            Trend Chi-square (χ²)
        </div>
        <div class="enhanced-stat-value">${results.chi_square.toFixed(4)}</div>
        <div class="enhanced-stat-description">
            For linear trend<br><strong>df = 1</strong>
        </div>
    </div>
    
    <div class="enhanced-stat-card">
        <div class="enhanced-stat-card-title">
            <i class="fas fa-percentage"></i>
            Trend P-value
        </div>
        <div class="enhanced-stat-value highlight">${pValueDisplay}</div>
        <div class="enhanced-stat-description">
            Cochran-Armitage test (${testTypeText})
        </div>
    </div>
</div>
                        
                        <!-- Chi-square Test of Association Highlight -->
                        <div class="chi-square-highlight">
                            <div class="chi-square-highlight-title">
                                <i class="fas fa-compress-alt"></i>
                                Chi-square Test of Association
                            </div>
                            <div>
                                <span class="chi-square-value">${results.chi_square_association.statistic.toFixed(4)}</span>
                                <span class="chi-square-label">χ² (df = ${results.chi_square_association.df})</span>
                            </div>
                            <div style="margin-top: 0.75rem;">
                                <strong>P-value for association:</strong> ${results.chi_square_association.pValue.toFixed(6)}
                            </div>
                            <div class="chi-square-comparison">
                                <i class="fas fa-info-circle"></i> This tests general association (not specifically trend). Compare with trend p-value above.
                            </div>
                        </div>
                        
                        <!-- Significance Interpretation -->
                        <div class="significance-box ${results.p_value < 0.05 ? 'significant' : 'not-significant'}">
                            <div class="significance-content">
                                <i class="fas fa-${results.p_value < 0.05 ? 'check' : 'times'}-circle significance-icon" 
                                   style="color: ${results.p_value < 0.05 ? 'var(--success)' : 'var(--danger)'};"></i>
                                <div class="significance-text">
                                    <div class="significance-title">
                                        ${results.p_value < 0.05 ? 'Significant Trend Detected' : 'No Significant Trend Detected'}
                                    </div>
                                    <div style="color: var(--text); font-size: 1rem; font-weight: 500;">
                                        ${results.p_value < 0.05 ? 
                                            `Statistically significant trend detected (p = ${pValueDisplay})` : 
                                            `No significant trend detected (p = ${pValueDisplay})`}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Interpretation -->
                        <div class="interpretation">
                            <div class="interpretation-title">
                                <i class="fas fa-lightbulb"></i>
                                Statistical Interpretation
                            </div>
                            <p style="color: var(--text); line-height: 1.7; margin-bottom: 1.25rem; font-size: 1rem; font-weight: 500;">
                                ${interpretation}
                            </p>
                            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid rgba(138, 180, 248, 0.3);">
                                <div style="font-weight: 600; color: var(--text); margin-bottom: 0.75rem; font-size: 1rem;">
                                    Practical Implications:
                                </div>
                                <p style="color: var(--text); line-height: 1.7; font-size: 1rem; font-weight: 500;">
                                    ${implications}
                                </p>
                            </div>
                        </div>
                        
<!-- Visualization -->
<div style="margin-top: 2.25rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); display: flex; align-items: center; gap: 0.875rem;">
            <i class="fas fa-chart-bar"></i>
            Data Visualization
        </h3>
        <div style="display: flex; gap: 0.75rem;">
            <button class="btn-secondary" id="fullscreenChartBtn" style="padding: 0.75rem 1.25rem; font-size: 0.9rem;">
                <i class="fas fa-expand"></i>
                Full Screen
            </button>
            <button class="btn-primary" id="downloadChartBtn" style="padding: 0.75rem 1.25rem; font-size: 0.9rem; display: inline-flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-download"></i>
                Download PNG
            </button>
        </div>
    </div>
    <div class="chart-container">
        <canvas id="analysisChart"></canvas>
    </div>
    
  <!-- Full Screen Modal -->
<div id="fullscreenModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 9999; flex-direction: column; align-items: center; justify-content: center;">
    <div style="width: 95%; height: 90%; background: white; border-radius: 8px; padding: 1rem; position: relative; box-shadow: 0 10px 40px rgba(0,0,0,0.1);">
        <button id="closeFullscreenBtn" style="position: absolute; top: 1rem; right: 1rem; background: var(--primary); color: white; border: none; border-radius: 6px; width: 44px; height: 44px; font-size: 1.25rem; cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 10000; box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3); transition: all 0.2s ease;">
            <i class="fas fa-times"></i>
        </button>
        <div style="width: 100%; height: 100%; position: relative; overflow: auto;">
            <canvas id="fullscreenChart"></canvas>
        </div>
    </div>
    <div style="margin-top: 1.5rem; display: flex; gap: 1rem; background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        <button class="fullscreen-control-btn" id="zoomInFullscreenBtn" style="padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);">
            <i class="fas fa-search-plus"></i>
            Zoom In
        </button>
        <button class="fullscreen-control-btn" id="zoomOutFullscreenBtn" style="padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);">
            <i class="fas fa-search-minus"></i>
            Zoom Out
        </button>
        <button class="fullscreen-control-btn" id="resetZoomFullscreenBtn" style="padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);">
            <i class="fas fa-sync-alt"></i>
            Reset Zoom
        </button>
        <button class="fullscreen-control-btn" id="downloadFullscreenChartBtn" style="padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);">
            <i class="fas fa-download"></i>
            Download
        </button>
    </div>
</div>
    
    <p style="text-align: center; color: var(--secondary); margin-top: 1.25rem; font-size: 1rem; font-weight: 500;">
        <i class="fas fa-info-circle"></i> 
        Chart shows frequency distribution with selected labels (${showCounts ? 'counts' : ''}${showCounts && (showRowPercent || showColPercent) ? ', ' : ''}${showRowPercent ? 'row %' : ''}${showRowPercent && showColPercent ? ', ' : ''}${showColPercent ? 'column %' : ''})
        <br>
        <small>Click "Full Screen" to inspect chart details or click directly on the chart to view it in full screen</small>
    </p>
</div>
</div>
                    
                    <!-- Export Section -->
                    <div class="export-section">
                        <h3 class="export-title">
                            <i class="fas fa-file-export"></i>
                            Export Results
                        </h3>
                        <p class="export-desc">
                            Download your analysis results in various formats for reporting, publication, or further analysis.
                        </p>
                        
                        <div class="export-options">
                            <div class="export-option">
                                <div class="export-icon">
                                    <i class="fas fa-file-word"></i>
                                </div>
                                <div class="export-option-title">Microsoft Word Report</div>
                                <div class="export-option-desc">Complete report with tables, results, and charts</div>
                                <button class="table-action-btn primary export-word-btn">
                                    <i class="fas fa-download"></i>
                                    Export Word
                                </button>
                            </div>
                            
                            <div class="export-option">
                                <div class="export-icon">
                                    <i class="fas fa-file-excel"></i>
                                </div>
                                <div class="export-option-title">Excel Spreadsheet</div>
                                <div class="export-option-desc">Data and results in Excel format for further analysis</div>
                                <button class="table-action-btn primary export-excel-btn">
                                    <i class="fas fa-download"></i>
                                    Export Excel
                                </button>
                            </div>
                            
                            <div class="export-option">
                                <div class="export-icon">
                                    <i class="fas fa-file-csv"></i>
                                </div>
                                <div class="export-option-title">CSV Data</div>
                                <div class="export-option-desc">Raw data in CSV format for statistical software</div>
                                <button class="table-action-btn primary export-csv-btn">
                                    <i class="fas fa-download"></i>
                                    Export CSV
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Citation Section -->
                    <div class="citation-section">
                        <h2 class="citation-title">
                            <i class="fas fa-book"></i>
                            Citation for Research
                        </h2>
                        <p style="color: var(--text); margin-bottom: 1.25rem; font-size: 1rem; font-weight: 500;">
                            If you use CATrend Analyzer in your research, please cite it as:
                        </p>
                        <div class="citation-box">
                            Ibrahim, M. M. (2026). <em>CATrend Analyzer: Cochran-Armitage Trend Test Analysis Tool</em> [Computer software]. Retrieved from [website url]
                        </div>
                        <p style="color: var(--secondary); font-size: 1rem; font-weight: 500; margin-top: 1.25rem;">
                            <strong>Software Information:</strong> This analysis was performed using CATrend Analyzer v1.0, 
                            developed by Mudasir Mohammed Ibrahim. The software implements the exact Cochran-Armitage formula 
                            (Z = Σ yⱼ(xⱼ - x̄) / √[p̄(1-p̄) Σ nⱼ(xⱼ - x̄)²]) for trend analysis in proportions across ordered categorical variables.
                        </p>
                    </div>
                `;
                
                // Show results section
                resultsSection.classList.add('active');
                
                // Update chart
                updateChart(results);
                
                // Full screen chart functionality
let fullscreenChartInstance = null;
let chartZoomLevel = 1;
const MAX_ZOOM = 3;
const MIN_ZOOM = 0.5;
const ZOOM_STEP = 0.1;

function openFullscreenChart() {
    const modal = document.getElementById('fullscreenModal');
    const fullscreenCanvas = document.getElementById('fullscreenChart');
    const ctx = fullscreenCanvas.getContext('2d');
    
    // Show modal
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    
    // Copy chart data from original chart
    const originalChart = chartInstance;
    
    // Destroy existing fullscreen chart if it exists
    if (fullscreenChartInstance) {
        fullscreenChartInstance.destroy();
    }
    
    // Create fullscreen chart with enhanced options
    fullscreenChartInstance = new Chart(ctx, {
        type: 'bar',
        data: JSON.parse(JSON.stringify(originalChart.data)), // Deep copy
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Frequency Distribution with Percentages - Full Screen View',
                    font: {
                        size: 24,
                        family: 'Inter',
                        weight: '700'
                    },
                    color: getComputedStyle(document.body).getPropertyValue('--text'),
                    padding: {
                        top: 20,
                        bottom: 30
                    }
                },
                legend: {
                    position: 'top',
                    labels: {
                        font: {
                            family: 'Inter',
                            size: 18,
                            weight: '600'
                        },
                        color: getComputedStyle(document.body).getPropertyValue('--text'),
                        padding: 20,
                        usePointStyle: true,
                        pointStyle: 'circle'
                    }
                },
                tooltip: {
                    backgroundColor: getComputedStyle(document.body).getPropertyValue('--card-bg'),
                    borderColor: getComputedStyle(document.body).getPropertyValue('--border'),
                    borderWidth: 2,
                    padding: 16,
                    titleFont: {
                        size: 16,
                        family: 'Inter',
                        weight: '600'
                    },
                    bodyFont: {
                        size: 15,
                        family: 'Inter',
                        weight: '500'
                    },
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            label += context.parsed.y;
                            
                            if (showRowPercent) {
                                const rowIndex = context.datasetIndex;
                                const colIndex = context.dataIndex;
                                label += ` (${results.rowPercentages[rowIndex][colIndex]}% of row)`;
                            }
                            if (showColPercent) {
                                const rowIndex = context.datasetIndex;
                                const colIndex = context.dataIndex;
                                label += ` [${results.colPercentages[rowIndex][colIndex]}% of column]`;
                            }
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    color: function(context) {
                        const dataset = context.dataset;
                        const backgroundColor = dataset.backgroundColor;
                        if (backgroundColor === 'rgba(52, 168, 83, 0.7)' || backgroundColor === 'rgba(234, 67, 53, 0.7)') {
                            return '#ffffff';
                        }
                        return '#000000';
                    },
                    font: {
                        weight: '600',
                        size: 14
                    },
                    formatter: function(value, context) {
                        const labels = context.chart.data.datasets[context.datasetIndex].dataLabels;
                        return labels ? labels[context.dataIndex] : value;
                    },
                    anchor: 'center',
                    align: 'center'
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Groups',
                        font: {
                            family: 'Inter',
                            size: 20,
                            weight: '700'
                        },
                        color: getComputedStyle(document.body).getPropertyValue('--text'),
                        padding: { top: 20 }
                    },
                    grid: {
                        color: getComputedStyle(document.body).getPropertyValue('--chart-grid'),
                        lineWidth: 2
                    },
                    ticks: {
                        color: getComputedStyle(document.body).getPropertyValue('--chart-text'),
                        font: {
                            size: 16,
                            weight: '600'
                        },
                        padding: 10
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: 'Frequency',
                        font: {
                            family: 'Inter',
                            size: 20,
                            weight: '700'
                        },
                        color: getComputedStyle(document.body).getPropertyValue('--text'),
                        padding: { bottom: 20 }
                    },
                    beginAtZero: true,
                    ticks: {
                        precision: 0,
                        color: getComputedStyle(document.body).getPropertyValue('--chart-text'),
                        font: {
                            size: 16,
                            weight: '600'
                        },
                        padding: 10
                    },
                    grid: {
                        color: getComputedStyle(document.body).getPropertyValue('--chart-grid'),
                        lineWidth: 2
                    }
                }
            },
            animation: {
                duration: 1000,
                easing: 'easeOutQuart'
            },
            interaction: {
                intersect: false,
                mode: 'index'
            }
        }
    });
    
    // Apply initial zoom
    applyChartZoom();
}

function closeFullscreenChart() {
    const modal = document.getElementById('fullscreenModal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
    chartZoomLevel = 1; // Reset zoom level
    
    // Destroy fullscreen chart
    if (fullscreenChartInstance) {
        fullscreenChartInstance.destroy();
        fullscreenChartInstance = null;
    }
}

function applyChartZoom() {
    if (!fullscreenChartInstance) return;
    
    const canvas = document.getElementById('fullscreenChart');
    const container = canvas.parentElement;
    
    // Apply zoom transform
    canvas.style.transform = `scale(${chartZoomLevel})`;
    canvas.style.transformOrigin = 'center center';
    
    // Adjust container size based on zoom
    container.style.overflow = 'auto';
    container.style.width = '100%';
    container.style.height = '100%';
}

function zoomInChart() {
    if (chartZoomLevel < MAX_ZOOM) {
        chartZoomLevel += ZOOM_STEP;
        applyChartZoom();
    }
}

function zoomOutChart() {
    if (chartZoomLevel > MIN_ZOOM) {
        chartZoomLevel -= ZOOM_STEP;
        applyChartZoom();
    }
}

function resetChartZoom() {
    chartZoomLevel = 1;
    applyChartZoom();
}

function downloadFullscreenChart() {
    if (fullscreenChartInstance) {
        // Create download link
        const link = document.createElement('a');
        link.download = 'catrend-analysis-chart-fullscreen.png';
        link.href = fullscreenChartInstance.toBase64Image();
        link.click();
    }
}

// Also allow clicking on the chart itself to open fullscreen
document.getElementById('analysisChart')?.addEventListener('click', function() {
    openFullscreenChart();
});

// Add event listeners for fullscreen functionality
document.getElementById('fullscreenChartBtn')?.addEventListener('click', openFullscreenChart);
document.getElementById('closeFullscreenBtn')?.addEventListener('click', closeFullscreenChart);
document.getElementById('zoomInFullscreenBtn')?.addEventListener('click', zoomInChart);
document.getElementById('zoomOutFullscreenBtn')?.addEventListener('click', zoomOutChart);
document.getElementById('resetZoomFullscreenBtn')?.addEventListener('click', resetChartZoom);
document.getElementById('downloadFullscreenChartBtn')?.addEventListener('click', downloadFullscreenChart);

// Close modal with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && document.getElementById('fullscreenModal').style.display === 'flex') {
        closeFullscreenChart();
    }
});

// Close modal when clicking outside the chart container
document.getElementById('fullscreenModal')?.addEventListener('click', function(e) {
    if (e.target.id === 'fullscreenModal') {
        closeFullscreenChart();
    }
});
                
                // Setup event listeners for new buttons
                document.getElementById('downloadChartBtn').addEventListener('click', downloadChart);
                document.querySelector('.export-word-btn').addEventListener('click', exportToWord);
                document.querySelector('.export-excel-btn').addEventListener('click', exportToExcel);
                document.querySelector('.export-csv-btn').addEventListener('click', exportToCSV);
                
                // Scroll to results
                setTimeout(() => {
                    resultsSection.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            }

            // Update home visualization with analysis results
            function updateHomeVisualizationWithResults(results) {
                const visualizationData = {
                    title: "Cochran-Armitage Trend Analysis",
                    subtitle: `Analysis Results: ${results.p_value < 0.05 ? 'Significant Trend' : 'No Significant Trend'}`,
                    labels: currentData.cols,
                    successRates: results.successRates,
                    failureRates: currentData.data[1] || results.nj.map((n, i) => n - results.yj[i]),
                    totals: results.nj,
                    stats: {
                        z: results.z.toFixed(2),
                        p: results.p_value < 0.001 ? "<0.001" : results.p_value.toFixed(3),
                        trend: results.p_value < 0.05 ? 
                            (results.testType === 'one.sided.increasing' ? "Increasing" : 
                             results.testType === 'one.sided.decreasing' ? "Decreasing" : 
                             results.numerator > 0 ? "Increasing" : "Decreasing") : "No Significant Trend"
                    },
                    tableData: {
                        success: results.yj,
                        failure: results.nj.map((n, i) => n - results.yj[i]),
                        total: results.nj
                    }
                };
                
                // Update the home page visualization
                initializeTrendVisualization(visualizationData);
            }

            // Update chart
            function updateChart(results) {
                const ctx = document.getElementById('analysisChart').getContext('2d');
                
                // Destroy existing chart
                if (chartInstance) {
                    chartInstance.destroy();
                }
                
                const showCounts = document.getElementById('showCounts').checked;
                const showRowPercent = document.getElementById('showRowPercent').checked;
                const showColPercent = document.getElementById('showColPercent').checked;
                
                // Prepare data
                const labels = currentData.cols;
                const datasets = currentData.rows.map((row, rowIndex) => {
                    const data = currentData.data[rowIndex];
                    
                    // Generate labels based on selected options
                    const dataLabels = data.map((value, colIndex) => {
                        let label = '';
                        if (showCounts) {
                            label += value;
                        }
                        if (showRowPercent && showCounts) {
                            label += '\n(' + results.rowPercentages[rowIndex][colIndex] + '%)';
                        } else if (showRowPercent) {
                            label += results.rowPercentages[rowIndex][colIndex] + '%';
                        }
                        if (showColPercent && showCounts) {
                            label += '\n[' + results.colPercentages[rowIndex][colIndex] + '%]';
                        } else if (showColPercent) {
                            label += '[' + results.colPercentages[rowIndex][colIndex] + '%]';
                        }
                        return label.trim();
                    });
                    
                    return {
                        label: row,
                        data: data,
                        dataLabels: dataLabels, // Store labels for datalabels plugin
                        backgroundColor: rowIndex === 0 ? 
                            'rgba(52, 168, 83, 0.7)' : 'rgba(234, 67, 53, 0.7)',
                        borderColor: rowIndex === 0 ? 
                            'rgba(52, 168, 83, 1)' : 'rgba(234, 67, 53, 1)',
                        borderWidth: 2
                    };
                });                
                
                // Create new chart
                chartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Frequency Distribution with Percentages',
                                font: {
                                    size: 18,
                                    family: 'Inter',
                                    weight: '700'
                                },
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            },
                            legend: {
                                position: 'top',
                                labels: {
                                    font: {
                                        family: 'Inter',
                                        size: 16,
                                        weight: '600'
                                    },
                                    color: getComputedStyle(document.body).getPropertyValue('--text')
                                }
                            },
                            tooltip: {
                                backgroundColor: getComputedStyle(document.body).getPropertyValue('--card-bg'),
                                borderColor: getComputedStyle(document.body).getPropertyValue('--border'),
                                borderWidth: 1,
                                padding: 12,
                                titleFont: {
                                    size: 14,
                                    family: 'Inter',
                                    weight: '600'
                                },
                                bodyFont: {
                                    size: 13,
                                    family: 'Inter',
                                    weight: '500'
                                },
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        label += context.parsed.y;
                                        
                                        if (showRowPercent) {
                                            const rowIndex = context.datasetIndex;
                                            const colIndex = context.dataIndex;
                                            label += ` (${results.rowPercentages[rowIndex][colIndex]}% of row)`;
                                        }
                                        if (showColPercent) {
                                            const rowIndex = context.datasetIndex;
                                            const colIndex = context.dataIndex;
                                            label += ` [${results.colPercentages[rowIndex][colIndex]}% of column]`;
                                        }
                                        return label;
                                    }
                                }
                            },
                            datalabels: {
                                display: true,
                                color: function(context) {
                                    // Make labels white on dark bars, black on light bars
                                    const dataset = context.dataset;
                                    const backgroundColor = dataset.backgroundColor;
                                    // Check if background is dark
                                    if (backgroundColor === 'rgba(52, 168, 83, 0.7)' || backgroundColor === 'rgba(234, 67, 53, 0.7)') {
                                        return '#ffffff'; // White text for colored bars
                                    }
                                    return '#000000'; // Black text for light bars
                                },
                                font: {
                                    weight: '600',
                                    size: 12
                                },
                                formatter: function(value, context) {
                                    // Get the label from our pre-calculated dataLabels
                                    const labels = context.chart.data.datasets[context.datasetIndex].dataLabels;
                                    return labels ? labels[context.dataIndex] : value;
                                },
                                anchor: 'center',
                                align: 'center'
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Groups',
                                    font: {
                                        family: 'Inter',
                                        size: 16,
                                        weight: '700'
                                    },
                                    color: getComputedStyle(document.body).getPropertyValue('--text')
                                },
                                grid: {
                                    color: getComputedStyle(document.body).getPropertyValue('--chart-grid')
                                },
                                ticks: {
                                    color: getComputedStyle(document.body).getPropertyValue('--chart-text')
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Frequency',
                                    font: {
                                        family: 'Inter',
                                        size: 16,
                                        weight: '700'
                                    },
                                    color: getComputedStyle(document.body).getPropertyValue('--text')
                                },
                                beginAtZero: true,
                                ticks: {
                                    precision: 0,
                                    color: getComputedStyle(document.body).getPropertyValue('--chart-text')
                                },
                                grid: {
                                    color: getComputedStyle(document.body).getPropertyValue('--chart-grid')
                                }
                            }
                        }
                    }
                });
            }

            // Download chart as image
            function downloadChart() {
                if (chartInstance) {
                    // First, temporarily disable animation for clean snapshot
                    const originalAnimation = chartInstance.options.animation;
                    chartInstance.options.animation = false;
                    
                    // Force a chart update to render all labels
                    chartInstance.update('none');
                    
                    // Create download link
                    const link = document.createElement('a');
                    link.download = 'catrend-analysis-chart.png';
                    link.href = chartInstance.toBase64Image();
                    link.click();
                    
                    // Restore animation setting
                    chartInstance.options.animation = originalAnimation;
                    chartInstance.update('none');
                }
            }

            // Export to Word
            function exportToWord() {
                const results = performCochranArmitageTest();
                if (!results) return;
                
                // Create chart image for Word document
                let chartImage = '';
                if (chartInstance) {
                    chartImage = `<img src="${chartInstance.toBase64Image()}" alt="Analysis Chart" style="max-width: 100%; height: auto; margin: 20px 0;">`;
                }
                
                // Generate table HTML
                let tableHTML = '<table>';
                tableHTML += '<tr><th></th>';
                currentData.cols.forEach(col => {
                    tableHTML += `<th>${col}</th>`;
                });
                tableHTML += '<th>Total</th><th>Row %</th></tr>';
                
                currentData.rows.forEach((row, rowIndex) => {
                    tableHTML += `<tr><th>${row}</th>`;
                    currentData.data[rowIndex].forEach(cell => {
                        tableHTML += `<td>${cell}</td>`;
                    });
                    const rowTotal = currentData.data[rowIndex].reduce((a, b) => a + b, 0);
                    const rowPercent = (rowTotal / results.N * 100).toFixed(1);
                    tableHTML += `<td><strong>${rowTotal}</strong></td>`;
                    tableHTML += `<td><strong>${rowPercent}%</strong></td></tr>`;
                });
                
                tableHTML += '<tr><th>Total</th>';
                currentData.cols.forEach((_, colIndex) => {
                    const colTotal = currentData.data.reduce((sum, row) => sum + row[colIndex], 0);
                    tableHTML += `<td><strong>${colTotal}</strong></td>`;
                });
                tableHTML += `<td><strong>${results.N}</strong></td><td><strong>100.0%</strong></td></tr>`;
                
                // Add expected counts
                const showExpected = document.getElementById('showExpectedCounts')?.checked;
                if (showExpected) {
                    tableHTML += '<tr><th><em>Expected</em></th>';
                    currentData.cols.forEach((_, colIndex) => {
                        currentData.rows.forEach((_, rowIndex) => {
                            const expected = (results.rowTotals[rowIndex] * results.colTotals[colIndex]) / results.N;
                            tableHTML += `<td><em>${expected.toFixed(1)}</em></td>`;
                        });
                    });
                    tableHTML += '<td><em>-</em></td><td><em>-</em></td></tr>';
                }
                tableHTML += '</table>';
                
                // Generate interpretation
                let interpretation = '';
                if (results.p_value < 0.001) {
                    interpretation = `There is a highly significant trend in proportions across the ordered groups (p < 0.001). `;
                } else if (results.p_value < 0.01) {
                    interpretation = `There is a very significant trend in proportions across the ordered groups (p < 0.01). `;
                } else if (results.p_value < 0.05) {
                    interpretation = `There is a statistically significant trend in proportions across the ordered groups (p < 0.05). `;
                } else {
                    interpretation = `No statistically significant trend was detected across the ordered groups (p = ${results.p_value.toFixed(4)}). `;
                }
                
                if (results.testType === 'one.sided.increasing' && results.p_value < 0.05) {
                    interpretation += `The evidence supports an increasing trend across groups.`;
                } else if (results.testType === 'one.sided.decreasing' && results.p_value < 0.05) {
                    interpretation += `The evidence supports a decreasing trend across groups.`;
                } else if (results.p_value < 0.05) {
                    interpretation += `There is a systematic relationship between the outcome and the ordered groups.`;
                } else {
                    interpretation += `This suggests no systematic relationship between the outcome and the ordered groups.`;
                }
                
                const testTypeText = {
                    'two.sided': 'Two-sided',
                    'one.sided.increasing': 'One-sided (increasing)',
                    'one.sided.decreasing': 'One-sided (decreasing)'
                }[results.testType];
                
                const content = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>Cochran-Armitage Test Report</title>
                        <style>
                            body {
                                font-family: 'Calibri', sans-serif;
                                margin: 40px;
                                line-height: 1.6;
                                color: #202124;
                            }
                            h1 {
                                color: #1a73e8;
                                border-bottom: 2px solid #1a73e8;
                                padding-bottom: 10px;
                            }
                            h2 {
                                color: #202124;
                                margin-top: 30px;
                                padding-bottom: 5px;
                                border-bottom: 1px solid #ddd;
                            }
                            table {
                                border-collapse: collapse;
                                width: 100%;
                                margin: 20px 0;
                                font-size: 11pt;
                            }
                            th, td {
                                border: 1px solid #ddd;
                                padding: 12px;
                                text-align: center;
                            }
                            th {
                                background-color: #f8f9fa;
                                color: #202124;
                                font-weight: bold;
                            }
                            .stat-box {
                                background-color: #f8f9fa;
                                padding: 15px;
                                border-left: 4px solid #1a73e8;
                                margin: 15px 0;
                            }
                            .significant {
                                background-color: #e8f5e9;
                                padding: 15px;
                                border-radius: 4px;
                                border-left: 4px solid #34a853;
                            }
                            .not-significant {
                                background-color: #ffebee;
                                padding: 15px;
                                border-radius: 4px;
                                border-left: 4px solid #ea4335;
                            }
                            .footer {
                                margin-top: 40px;
                                padding-top: 20px;
                                border-top: 1px solid #ddd;
                                font-size: 10pt;
                                color: #666;
                                text-align: center;
                            }
                            .citation {
                                background-color: #f8f9fa;
                                padding: 15px;
                                border-left: 4px solid #666;
                                margin: 20px 0;
                                font-family: 'Times New Roman', serif;
                                font-size: 12pt;
                            }
                        </style>
                    </head>
                    <body>
                        <h1>Cochran-Armitage Trend Test Report</h1>
                        <p><strong>Generated:</strong> ${new Date().toLocaleString()}</p>
                        <p><strong>Software:</strong> CATrend Analyzer v1.0</p>
                        
                        <h2>Contingency Table</h2>
                        ${tableHTML}
                        
                        <h2>Statistical Results</h2>
                        <div class="stat-box">
                            <table style="width: 60%;">
                                <tr>
                                    <th>Statistic</th>
                                    <th>Value</th>
                                </tr>
                                <tr>
                                    <td>Z-statistic</td>
                                    <td>${results.z.toFixed(4)}</td>
                                </tr>
                                <tr>
                                    <td>Chi-square (χ²)</td>
                                    <td>${results.chi_square.toFixed(4)}</td>
                                </tr>
                                <tr>
                                    <td>P-value (Trend)</td>
                                    <td>${results.p_value.toFixed(6)}</td>
                                </tr>
                                <tr>
                                    <td>Chi-square (Association)</td>
                                    <td>${results.chi_square_association.statistic.toFixed(4)}</td>
                                </tr>
                                <tr>
                                    <td>P-value (Association)</td>
                                    <td>${results.chi_square_association.pValue.toFixed(6)}</td>
                                </tr>
<tr>
    <td>Degrees of Freedom (Trend)</td>
    <td>1</td>
</tr>
<tr>
    <td>Degrees of Freedom (Association)</td>
    <td>${results.chi_square_association.df}</td>
</tr>
                                <tr>
                                    <td>Sample Size (N)</td>
                                    <td>${results.N}</td>
                                </tr>
                                <tr>
                                    <td>Number of Groups (k)</td>
                                    <td>${results.k}</td>
                                </tr>
                            </table>
                        </div>
                        
                        <h2>Significance Assessment</h2>
                        <div class="${results.p_value < 0.05 ? 'significant' : 'not-significant'}">
                            <strong>${results.p_value < 0.05 ? 'Statistically significant trend detected' : 'No significant trend detected'} (p = ${results.p_value.toFixed(4)})</strong>
                        </div>
                        
                        <h2>Interpretation</h2>
                        <p>${interpretation}</p>
                        
                        <h2>Data Visualization</h2>
                        ${chartImage}
                        
                        <h2>Test Parameters</h2>
                        <ul>
                            <li><strong>Test Type:</strong> ${testTypeText}</li>
                            <li><strong>Continuity Correction:</strong> ${results.continuityCorrection ? 'Applied' : 'Not applied'}</li>
                            <li><strong>Degrees of Freedom:</strong> ${results.degreesOfFreedom}</li>
                            <li><strong>Chart Labels:</strong> ${document.getElementById('showCounts').checked ? 'Counts ' : ''}${document.getElementById('showRowPercent').checked ? 'Row % ' : ''}${document.getElementById('showColPercent').checked ? 'Column %' : ''}</li>
                        </ul>
                        
                        <h2>Citation</h2>
                        <div class="citation">
                            Ibrahim, M. M. (2026). <em>CATrend Analyzer: Cochran-Armitage Trend Test Analysis Tool</em> [Computer software]. Retrieved from [website url]
                        </div>
                        
                        <div class="footer">
                            <p><strong>Software Information:</strong> This analysis was performed using CATrend Analyzer v1.0, 
                            developed by Mudasir Mohammed Ibrahim. The software implements the exact Cochran-Armitage formula 
                            for trend analysis in proportions across ordered categorical variables.</p>
                            <p>Report generated by CATrend Analyzer | Developed by Mudasir Mohammed Ibrahim</p>
                            <p>Contact: mudassiribrahim30@gmail.com</p>
                            <p>© ${new Date().getFullYear()} CATrend Analyzer. All rights reserved.</p>
                        </div>
                        </div>
                    </body>
                    </html>
                `;
                
                const blob = new Blob([content], { type: 'application/msword' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Cochran-Armitage-Report-${new Date().toISOString().slice(0,10)}.doc`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            // Export to Excel
            function exportToExcel() {
                const results = performCochranArmitageTest();
                if (!results) return;
                
                // Create Excel content
                let excelContent = 'Cochran-Armitage Trend Test Analysis\n';
                excelContent += `Generated: ${new Date().toLocaleString()}\n\n`;
                
                // Contingency table
                excelContent += 'Contingency Table\n';
                excelContent += ',' + currentData.cols.join(',') + ',Total,Row %\n';
                
                currentData.rows.forEach((row, rowIndex) => {
                    const rowData = currentData.data[rowIndex];
                    const rowTotal = rowData.reduce((a, b) => a + b, 0);
                    const rowPercent = (rowTotal / results.N * 100).toFixed(1);
                    excelContent += `${row},${rowData.join(',')},${rowTotal},${rowPercent}%\n`;
                });
                
                // Column totals
                const colTotals = currentData.cols.map((_, colIndex) => 
                    currentData.data.reduce((sum, row) => sum + row[colIndex], 0)
                );
                excelContent += `Total,${colTotals.join(',')},${results.N},100.0%\n\n`;
                
                // Statistical results
                excelContent += 'Statistical Results\n';
                excelContent += 'Statistic,Value\n';
                excelContent += `Z-statistic,${results.z.toFixed(4)}\n`;
                excelContent += `Chi-square (χ²),${results.chi_square.toFixed(4)}\n`;
                excelContent += `P-value (Trend),${results.p_value.toFixed(6)}\n`;
                excelContent += `Chi-square (Association),${results.chi_square_association.statistic.toFixed(4)}\n`;
                excelContent += `P-value (Association),${results.chi_square_association.pValue.toFixed(6)}\n`;
excelContent += `Degrees of Freedom (Trend),1\n`;
excelContent += `Degrees of Freedom (Association),${results.chi_square_association.df}\n`;
                excelContent += `Sample Size (N),${results.N}\n`;
                excelContent += `Number of Groups (k),${results.k}\n`;
                
                // Test parameters
                const testTypeText = {
                    'two.sided': 'Two-sided',
                    'one.sided.increasing': 'One-sided (increasing)',
                    'one.sided.decreasing': 'One-sided (decreasing)'
                }[results.testType];
                
                excelContent += '\nTest Parameters\n';
                excelContent += `Test Type,${testTypeText}\n`;
                excelContent += `Continuity Correction,${results.continuityCorrection ? 'Yes' : 'No'}\n`;
                excelContent += `Analysis Date,${new Date().toLocaleDateString()}\n`;
                
                const blob = new Blob([excelContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Cochran-Armitage-Analysis-${new Date().toISOString().slice(0,10)}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            // Export to CSV
            function exportToCSV() {
                // Create CSV content
                let csvContent = 'Row,Column,Count,Row Percentage,Column Percentage\n';
                
                currentData.rows.forEach((row, rowIndex) => {
                    currentData.cols.forEach((col, colIndex) => {
                        const count = currentData.data[rowIndex][colIndex];
                        const rowTotal = currentData.data[rowIndex].reduce((a, b) => a + b, 0);
                        const colTotal = currentData.data.reduce((sum, r) => sum + r[colIndex], 0);
                        const rowPercent = rowTotal > 0 ? (count / rowTotal * 100).toFixed(1) : '0.0';
                        const colPercent = colTotal > 0 ? (count / colTotal * 100).toFixed(1) : '0.0';
                        
                        csvContent += `"${row}","${col}",${count},${rowPercent},${colPercent}\n`;
                    });
                });
                
                // Add totals
                csvContent += '\nTotals\n';
                csvContent += 'Type,Value\n';
                csvContent += `Total Observations,${currentData.data.flat().reduce((a, b) => a + b, 0)}\n`;
                csvContent += `Number of Rows,${currentData.rows.length}\n`;
                csvContent += `Number of Columns,${currentData.cols.length}\n`;
                
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Cochran-Armitage-Data-${new Date().toISOString().slice(0,10)}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            // Validate data before running analysis
            function validateData() {
                const allCells = document.querySelectorAll('#contingencyTable input[type="number"]');
                let hasData = false;
                
                for (const cell of allCells) {
                    const value = parseInt(cell.value) || 0;
                    if (value > 0) {
                        hasData = true;
                        break;
                    }
                }
                
                const dataWarning = document.getElementById('dataWarning');
                if (!hasData) {
                    dataWarning.style.display = 'flex';
                    return false;
                }
                
                dataWarning.style.display = 'none';
                return true;
            }

            // Run analysis
            function runAnalysis() {
                if (validateData()) {
                    const results = performCochranArmitageTest();
                    updateResults(results);
                }
            }

            // Initialize the table
            updateTable();
            
            // Add event listeners
            document.getElementById('addRowBtn').addEventListener('click', addRow);
            document.getElementById('removeRowBtn').addEventListener('click', removeRow);
            document.getElementById('addColBtn').addEventListener('click', addColumn);
            document.getElementById('removeColBtn').addEventListener('click', removeColumn);
            document.getElementById('runAnalysisBtn').addEventListener('click', runAnalysis);
            
            // Add event listeners for display options
            document.getElementById('showExpectedCounts')?.addEventListener('change', updateTable);
            document.getElementById('showRowPercentages')?.addEventListener('change', updateTable);
            document.getElementById('showColPercentages')?.addEventListener('change', updateTable);
            
            // Add event listeners for chart options
            document.getElementById('showCounts').addEventListener('change', function() {
                if (chartInstance) {
                    const results = performCochranArmitageTest();
                    updateChart(results);
                }
            });
            
            document.getElementById('showRowPercent').addEventListener('change', function() {
                if (chartInstance) {
                    const results = performCochranArmitageTest();
                    updateChart(results);
                }
            });
            
            document.getElementById('showColPercent').addEventListener('change', function() {
                if (chartInstance) {
                    const results = performCochranArmitageTest();
                    updateChart(results);
                }
            });
            
            if (chartInstance) {
                // Force update to apply theme colors
                setTimeout(() => {
                    chartInstance.update();
                }, 100);
            }
            
            // Add welcome alert
            setTimeout(() => {
                const alert = document.createElement('div');
                alert.className = 'alert alert-info';
                alert.innerHTML = `
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Welcome to CATrend Analyzer Analysis!</strong> 
                        Start by modifying the table data, then click "Run Cochran-Armitage Test" to analyze trends across groups.
                        <br><br>
                        <strong>New Features:</strong>
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                            <li>Expected cell counts calculation</li>
                            <li>Row and column percentage totals</li>
                            <li>Chi-square test of association with p-value comparison</li>
                            <li>Degrees of freedom in results</li>
                            <li>Export to Excel and CSV formats</li>
                            <li>One-sided test as default configuration</li>
                        </ul>
                    </div>
                `;
                document.querySelector('#analysis .card').prepend(alert);
                
                // Remove alert after 15 seconds
                setTimeout(() => {
                    alert.remove();
                }, 15000);
            }, 1000);
        }

        // ============================================
        // THEME TOGGLE FUNCTIONS
        // ============================================
        function initializeThemeToggle() {
            const themeToggleBtn = document.getElementById('themeToggleBtn');
            const themeIcon = document.getElementById('themeIcon');
            const htmlElement = document.documentElement;
            
            // Check for saved theme preference or prefers-color-scheme
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
            const savedTheme = localStorage.getItem('catrend-theme');
            
            // Set initial theme
            if (savedTheme === 'dark' || (!savedTheme && prefersDarkScheme.matches)) {
                htmlElement.setAttribute('data-theme', 'dark');
                themeIcon.className = 'fas fa-sun';
                themeToggleBtn.title = 'Switch to Light Mode';
            } else {
                htmlElement.setAttribute('data-theme', 'light');
                themeIcon.className = 'fas fa-moon';
                themeToggleBtn.title = 'Switch to Dark Mode';
            }
            
            // Toggle theme function
            function toggleTheme() {
                const currentTheme = htmlElement.getAttribute('data-theme');
                
                if (currentTheme === 'light') {
                    htmlElement.setAttribute('data-theme', 'dark');
                    themeIcon.className = 'fas fa-sun';
                    themeToggleBtn.title = 'Switch to Light Mode';
                    localStorage.setItem('catrend-theme', 'dark');
                } else {
                    htmlElement.setAttribute('data-theme', 'light');
                    themeIcon.className = 'fas fa-moon';
                    themeToggleBtn.title = 'Switch to Light Mode';
                    localStorage.setItem('catrend-theme', 'light');
                }
                
                // Update Chart.js if it exists
                updateChartTheme();
            }
            
            // Update Chart.js theme
            function updateChartTheme() {
                const chart = Chart.getChart('analysisChart');
                if (chart) {
                    // Update chart colors
                    chart.options.scales.x.grid.color = getComputedStyle(document.body).getPropertyValue('--chart-grid');
                    chart.options.scales.x.ticks.color = getComputedStyle(document.body).getPropertyValue('--chart-text');
                    chart.options.scales.y.grid.color = getComputedStyle(document.body).getPropertyValue('--chart-grid');
                    chart.options.scales.y.ticks.color = getComputedStyle(document.body).getPropertyValue('--chart-text');
                    chart.options.plugins.title.color = getComputedStyle(document.body).getPropertyValue('--text');
                    chart.options.plugins.legend.labels.color = getComputedStyle(document.body).getPropertyValue('--text');
                    
                    // Update tooltip colors
                    chart.options.plugins.tooltip.backgroundColor = getComputedStyle(document.body).getPropertyValue('--card-bg');
                    chart.options.plugins.tooltip.titleColor = getComputedStyle(document.body).getPropertyValue('--text');
                    chart.options.plugins.tooltip.bodyColor = getComputedStyle(document.body).getPropertyValue('--text');
                    chart.options.plugins.tooltip.borderColor = getComputedStyle(document.body).getPropertyValue('--border');
                    
                    chart.update();
                }
            }
            
            // Add event listener
            themeToggleBtn.addEventListener('click', toggleTheme);
            
            // Listen for system theme changes
            prefersDarkScheme.addEventListener('change', (e) => {
                if (!localStorage.getItem('catrend-theme')) {
                    if (e.matches) {
                        htmlElement.setAttribute('data-theme', 'dark');
                        themeIcon.className = 'fas fa-sun';
                        themeToggleBtn.title = 'Switch to Light Mode';
                        updateChartTheme();
                    } else {
                        htmlElement.setAttribute('data-theme', 'light');
                        themeIcon.className = 'fas fa-moon';
                        themeToggleBtn.title = 'Switch to Light Mode';
                        updateChartTheme();
                    }
                }
            });
            
            // Add keyboard shortcut (Ctrl+Shift+T for theme toggle)
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key.toLowerCase() === 't') {
                    e.preventDefault();
                    toggleTheme();
                }
            });
        }

         // ============================================
        // ZOOM FUNCTIONALITY
        // ============================================
        function initializeZoom() {
            const zoomLevelElement = document.getElementById('zoomLevel');
            const zoomInBtn = document.getElementById('zoomInBtn');
            const zoomOutBtn = document.getElementById('zoomOutBtn');
            
            // Start at 100%
            currentZoom = 100;
            const minZoom = 50;
            const maxZoom = 200;
            const zoomStep = 10;
            
            // Load saved zoom level from localStorage
            const savedZoom = localStorage.getItem('catrend-zoom-level');
            if (savedZoom) {
                currentZoom = parseInt(savedZoom);
                applyZoom(currentZoom);
            } else {
                // Apply default 100% zoom if no saved preference
                applyZoom(currentZoom);
            }
            
            function applyZoom(zoom) {
                // Base font size is 16px, so zoom% = 16 * (zoom/100) px
                document.documentElement.style.fontSize = `${16 * (zoom / 100)}px`;
                if (zoomLevelElement) {
                    zoomLevelElement.textContent = `${zoom}%`;
                }
                localStorage.setItem('catrend-zoom-level', zoom.toString());
            }
            
            if (zoomInBtn) {
                zoomInBtn.addEventListener('click', () => {
                    if (currentZoom < maxZoom) {
                        currentZoom += zoomStep;
                        applyZoom(currentZoom);
                    }
                });
            }
            
            if (zoomOutBtn) {
                zoomOutBtn.addEventListener('click', () => {
                    if (currentZoom > minZoom) {
                        currentZoom -= zoomStep;
                        applyZoom(currentZoom);
                    }
                });
            }
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === '=') {
                    e.preventDefault();
                    if (zoomInBtn) zoomInBtn.click();
                } else if ((e.ctrlKey || e.metaKey) && e.key === '-') {
                    e.preventDefault();
                    if (zoomOutBtn) zoomOutBtn.click();
                } else if ((e.ctrlKey || e.metaKey) && e.key === '0') {
                    e.preventDefault();
                    currentZoom = 80;
                    applyZoom(currentZoom);
                }
            });
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function scrollToFeatures() {
            const featuresSection = document.querySelector('.features-grid');
            if (featuresSection) {
                featuresSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // ============================================
        // DOCUMENT LOAD INITIALIZATION
        // ============================================
            // ============================================
        // DOCUMENT LOAD INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing app...');
            
            // Register Chart.js datalabels plugin
            if (Chart) {
                Chart.register(ChartDataLabels);
            }
            
            // Show loading screen
            const loadingScreen = document.getElementById('loadingScreen');
            
            // Initialize app immediately
            initializeApp();
            
            // Hide loading screen after 1.5 seconds
            setTimeout(function() {
                loadingScreen.classList.add('hidden');
            }, 1500);
        });
    
    </script>
</body>
</html>
